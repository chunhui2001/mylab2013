<?xml version="1.0" encoding="utf-8"?>
<c:component type="chSourceHighlighting" componentId="chSourceHighlighting_1" xmlns:c="http://com.snnmo.website">
  <c:abstract>
    <![CDATA[
   
      
https://icon-sets.iconify.design/ic/info/ (Android 图标库) <br />
https://inloop.github.io/svg2android (在线转换将 svg 转换成 Android Drawable)
]]>
  </c:abstract>



  <c:entry style="margin-top:1em;color:rgb(175, 0, 190);font-size:2.2em;">
    <c:title>Install Dependencies</c:title>
    <c:desc>
      <c:desc1> <![CDATA[
      
      ]]></c:desc1>
    </c:desc>
    <c:sourceContent type="" title="" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# install dependencies    
$ sudo apt-get install lib32z1 lib32ncurses5 lib32stdc++6

http://www.android-studio.org/
https://dl.google.com/android/ADT-23.0.6.zip
https://dl.google.com/android/android-sdk_r24.4.1-linux.tgz
https://dl.google.com/dl/android/studio/ide-zips/3.0.1.0/android-studio-ide-171.4443003-linux.zip


  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="Install ADT for exlipse " id="sourceContent1" 
                     style="background-color:white;margin-top:1em;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[


https://blog.csdn.net/df981011512/article/details/78965757

# eclipse 安装 ADT 插件重启后不显示 Android SDK Manager 和 Android Virtual Device Manager 图标的解决办法：
1). 检查 ADT 是否正确安装：打开 Window ——> Preferences 属性，如果看到了名为 Android 的内容，说明 ok.
2). 在 Eclipse ->window->customize Perpective（定制视图）——> Command Groups Availability 然后把以 andorid 开头全部选项就可以了.

  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="Android SDK" id="sourceContent1" 
                     style="background-color:white;margin-top:1em;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[


mkdir /home/lcw/android_develop_tools  

unzip sdk-linux-2016-08-12.zip  && mv sdk /home/lcw/android_develop_tools 

export ANDROID_SDK_HOME=/home/lcw/android_develop_tools/sdk  
export PATH=$PATH:$ANDROID_SDK_HOME/tools:$ANDROID_SDK_HOME/platform-tools  

在终端输入“android”，能打开 Android SDK Manager，说明就成功了

1、我们在上一步骤中已经打开了Android SDK Manager，一定要确保 tools目录下安装的是最新的，否则在studio build的时候会失败

Tools 目录下选择:
    Android SDK Tools
    Android SDK Platform-tools
    Android SDK Build-tools (最高版本，最好都下载)



1). 启动 Android SDK Manager ，打开主界面，依次选择「Tools」、「Options...」，弹出『Android SDK Manager - Settings』窗口；
2). 在『Android SDK Manager - Settings』窗口中，在「HTTP Proxy Server」和「HTTP Proxy Port」输入框内填入 mirrors.neusoft.edu.cn 和 80，并且选中「Force https://... sources to be fetched using http://...」复选框。设置完成后单击「Close」按钮关闭『Android SDK Manager - Settings』窗口返回到主界面；
依次选择「Packages」、「Reload」。


  ]]>
    </c:sourceContent>



    <c:sourceContent type="html" title="Android SDK" id="sourceContent1" 
                     style="background-color:white;margin-top:1em;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[

<img src="/images/android/android-avd-settings.jpg" width="600px" />

  ]]>
    </c:sourceContent>


    <c:sourceContent type="" title="Android Studio" id="sourceContent1" 
                     style="background-color:white;margin-top:1em;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[


unzip android-studio-v2.1.1-linux-2016-08-11.zip  

./studio.sh  


  ]]>
    </c:sourceContent>


    <c:sourceContent type="" title="ADB" id="sourceContent1" 
                     style="background-color:white;margin-top:1em;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[

$ adb version
> Android Debug Bridge version 1.0.41
> Version 34.0.5-10900879
> Installed as /Users/keesh/Library/Android/sdk/platform-tools/adb
> Running on Darwin 23.2.0 (arm64)

$ adb devices
> List of devices attached
> emulator-5554 device

$ adb get-serialno
> emulator-5554

$ adb root

$ adb shell
> emu64a:/ $

$ adb -s emulator-5554 shell
> emu64a:/ $

# 列出当前设备的所有包名
$ adb -s emulator-5554 shell pm list packages

# 列出当前设备的所有包名和安装路径
$ adb -s emulator-5554 shell pm list packages -f

# 列出当前设备禁用的包名
$ adb -s emulator-5554 shell pm list packages -d

# 列出当前设备启用的包名
$ adb -s emulator-5554 shell pm list packages -e

# 列出当前设备系统应用包名
$ adb -s emulator-5554 shell pm list packages -s

# 列出当前设备安装的第三方包名
$ adb -s emulator-5554 shell pm list packages -3

# 卸载 apk
$ adb uninstall <包名>

# 输出所有已安装的自定义包
$ adb -s emulator-5554 shell pm list packages -3 | grep labs --color

# 卸载所有匹配到的包名
$ adb -s emulator-5554 shell pm list packages -3 | grep labs | awk -F':' '{cmd="adb -s emulator-5554 uninstall " $2; print cmd; system(cmd)}'

# 安装 apk (-r 覆盖安装)
$ adb install -r <apk文件路径>

# 安装 apk (-d 允许降级安装)
$ adb install -d <apk文件路径>

# 安装 apk (-g 安装时把所有权限都打开)
$ adb install -g <apk文件路径>

# 显示设备日志并输出到控制台
$ adb -s emulator-5554 shell logcat -v time

# 显示设备日志并输出到文件
$ adb -s emulator-5554 shell logcat -v time > <文件路径.log.txt>

# 显示设备型号
$ adb -s R5CTB05SBYN shell getprop ro.product.model

# 显示 Android 系统版本
$ adb -s R5CTB05SBYN shell getprop ro.build.version.release

# 显示手机屏幕分辨率
$ adb -s R5CTB05SBYN shell wm size

# 显示手机存储信息
$ adb -s R5CTB05SBYN shell df 

# 显示手机内存信息
$ adb -s R5CTB05SBYN shell cat /proc/meminfo 
> MemTotal:       11482748 kB
> MemFree:         2242276 kB
> MemAvailable:    5894856 kB
> Buffers:            1372 kB
> Cached:          4309868 kB
> SwapCached:       156400 kB
> Active:          2423420 kB
> Inactive:        4005684 kB
> Active(anon):     961736 kB
> Inactive(anon):  1194328 kB
> Active(file):    1461684 kB
> Inactive(file):  2811356 kB
> Unevictable:        6976 kB
> Mlocked:            3700 kB
> RbinTotal:       1048576 kB
> RbinAlloced:        7168 kB
> RbinPool:              0 kB
> RbinFree:        1041408 kB
> RbinCached:            0 kB
> ZeroedFree:            0 kB
> SwapTotal:       4194300 kB
> SwapFree:        1880772 kB
> Dirty:                 0 kB
> Writeback:             0 kB
> AnonPages:       1948088 kB
> Mapped:          1167612 kB
> Shmem:             35424 kB
> KReclaimable:     447448 kB
> Slab:             590720 kB
> SReclaimable:     197168 kB
> SUnreclaim:       393552 kB
> KernelStack:       88800 kB
> ShadowCallStack:   22216 kB
> PageTables:       171004 kB
> NFS_Unstable:          0 kB
> Bounce:                0 kB
> WritebackTmp:          0 kB
> CommitLimit:     9411384 kB
> Committed_AS:   144230488 kB
> VmallocTotal:   263061440 kB
> VmallocUsed:      297096 kB
> VmallocChunk:          0 kB
> Percpu:            15360 kB
> AnonHugePages:    272384 kB
> ShmemHugePages:        0 kB
> ShmemPmdMapped:        0 kB
> FileHugePages:         0 kB
> FilePmdMapped:         0 kB
> HugepagePool:     540672 kB
> CmaTotal:         487424 kB
> CmaFree:               0 kB
> dma_heap_pool:    168340 kB
> system:           297292 kB
> kgsl_pool:         81940 kB
> zram0:            541120 kB
> KgslSharedmem:    318656 kB

  ]]>
    </c:sourceContent>

    <c:comment>
      <c:comment1>
        <![CDATA[]]>
      </c:comment1>
    </c:comment>
  </c:entry>




  <c:entry style="margin-top:1em;color:rgb(175, 0, 190);font-size:2.2em;">
    <c:title><![CDATA[Styles and Themes User Interface Material Design System]]></c:title>
    <c:desc>
      <c:desc1 style="font-size:1.2em;"> <![CDATA[
      Material Design: <a href="https://m3.material.io/">https://m3.material.io/</a>
      ]]></c:desc1>
      <c:desc1 style="font-size:1.2em;margin-top:.325em;"> <![CDATA[
      material design palette: <a href="https://www.materialpalette.com/">https://www.materialpalette.com/</a>
      ]]></c:desc1>
    </c:desc>

    <c:sourceContent type="" title="Makefile" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:0em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
### 当前 Makefile 文件物理路径
ROOT_DIR:=$(shell dirname $(realpath $(firstword $(MAKEFILE_LIST))))

build:
  ./gradlew build -x test

tasks:
  ./gradlew tasks

install:
  ./gradlew installDebug
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="Update app/build.gradle.kts" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# app/build.gradle.kts
plugins {
    id("com.android.application")
    id("org.jetbrains.kotlin.android")
+    id("kotlin-kapt")
}

...

dependencies {
    
    ...

+    implementation("androidx.lifecycle:lifecycle-extensions:2.2.0")
+    implementation("androidx.recyclerview:recyclerview:1.3.2")
+    implementation("androidx.room:room-runtime:2.6.1")
+
+    implementation("com.squareup.retrofit2:retrofit:2.5.0")
+    implementation("com.squareup.retrofit2:converter-scalars:2.5.0")
+
+    kapt("androidx.room:room-compiler:2.6.1")
}
  ]]>
    </c:sourceContent>

    <c:sourceContent type="html" title="ConstraintLayout" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;font-size:1.625em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[

<div>
    <div style="float:left">
        <div style="margin-top:.625em;">
            拖拽三个 Button 并进行底部剧中对其
        </div>

        <div style="margin-top:.625em;">
            <img width="400px" src="/images/android/styles-and-themes/img1.png" />
        </div>
        <div style="margin-top:.625em;">
            <img width="400px" src="/images/android/styles-and-themes/img2.png" />
        </div>
    </div>

    <div style="float:left;margin-left:1em;">
        <div style="margin-top:.625em;">
            页面元素布局
        </div>

        <div style="margin-top:.625em;">
            <img width="400px" src="/images/android/styles-and-themes/img3.png" />
        </div>
    </div>
    <div class="clear"></div>
</div>
  ]]>
    </c:sourceContent>

    <c:sourceContent type="html" title="设计颜色主题" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;font-size:1.625em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
<div style="margin-top:.625em;">
    <a href="https://www.materialpalette.com/">https://www.materialpalette.com/</a>
</div>
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;font-size:1.625em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# colors.xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <color name="primary">#FF9800</color>
    <color name="primary_dark">#F57C00</color>
    <color name="primary_light">#FFE0B2</color>
    <color name="accent">#FF5722</color>
    <color name="primary_text">#212121</color>
    <color name="secondary_text">#757575</color>
    <color name="icons">#212121</color>
    <color name="divider">#BDBDBD</color>
</resources>

# themes.xml
<resources xmlns:tools="http://schemas.android.com/tools">
    <!-- Base application theme. -->
    <style name="Base.Theme.StyleAndThemesMaterialDesign" parent="Theme.Material3.DayNight.NoActionBar">
        <!-- Customize your light theme here. -->
        <item name="colorPrimary">@color/primary</item>
        <item name="colorPrimaryVariant">@color/primary_dark</item>
        <item name="colorOnPrimary">@color/white</item>

        <!-- Secondary brand color. -->
        <item name="colorSecondary">@color/accent</item>
        <item name="colorSecondaryVariant">@color/accent</item>
        <item name="colorOnSecondary">@color/white</item>
    </style>

    <style name="Theme.StyleAndThemesMaterialDesign" parent="Base.Theme.StyleAndThemesMaterialDesign" />

</resources>


class MainActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

+        val actionBar: ActionBar? = supportActionBar
+
+        // 设置 actionBar 背景色
+        actionBar?.setBackgroundDrawable(ColorDrawable(ContextCompat.getColor(this, R.color.primary_dark)))
+        
+        // 设置 actionBar 文本颜色
+        actionBar?.setTitleColor(Color.WHITE)
    }

+    private fun ActionBar.setTitleColor(color: Int) {
+        val text = SpannableString(title ?: "")
+        text.setSpan(ForegroundColorSpan(color),0,text.length, Spannable.SPAN_INCLUSIVE_INCLUSIVE)
+        title = text
+    }
}
  ]]>
    </c:sourceContent>

    <c:sourceContent type="html" title="" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;font-size:1.625em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
<div style="float:left">
    <div style="margin-top:.625em;float:left;">
        <img width="400px" src="/images/android/styles-and-themes/img8.png" />
    </div>
    <div style="margin-top:.625em;float:left;margin-left:.625em;">
        <img width="495px" src="/images/android/styles-and-themes/img4.png" />
    </div>
    <div class="clear"></div>
</div>
  ]]>
    </c:sourceContent>


    <c:sourceContent type="" title="设置全局 Button 样式" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;font-size:1.625em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# themes.xml
<resources xmlns:tools="http://schemas.android.com/tools">
    <!-- Base application theme. -->
    <style
        name="Base.Theme.StyleAndThemesMaterialDesign"
        parent="Theme.Material3.DayNight.NoActionBar">
        ...
+        <item name="materialButtonStyle">@style/myButton</item>
    </style>

    <style name="myButton" parent="Widget.Material3.Button">
        <item name="android:textSize">18sp</item>
        <item name="android:textColor">@color/white</item>
        <item name="android:textAllCaps">false</item>
        <item name="backgroundTint">@color/accent</item>
        <item name="cornerRadius">20dp</item>
    </style>
</resources>
  ]]>
    </c:sourceContent>

    <c:sourceContent type="html" title="" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;font-size:1.625em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
<div style="margin-top:.625em;">
    <img width="100%" src="/images/android/styles-and-themes/img5.png" />
</div>
  ]]>
    </c:sourceContent>


    <c:sourceContent type="" title="自定义按钮颜色" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;font-size:1.625em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# themes.xml
<resources xmlns:tools="http://schemas.android.com/tools">
    
    ....

+    <style name="otherButton" parent="Widget.Material3.Button">
+        <item name="android:textSize">18sp</item>
+        <item name="android:textColor">@color/white</item>
+        <item name="android:textAllCaps">false</item>
+        <item name="backgroundTint">@color/accent</item>
+        <item name="cornerRadius">10dp</item>
+    </style>
</resources>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="html" title="" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;font-size:1.625em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
<div style="margin-top:.625em;">
    <img width="100%" src="/images/android/styles-and-themes/img6.png" />
</div>
  ]]>
    </c:sourceContent>

    <c:sourceContent type="html" title="横向布局" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;font-size:1.625em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
<div style="margin-top:.625em;">
    <img width="100%" src="/images/android/styles-and-themes/img7.png" />
</div>
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="定制多个主题" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;font-size:1.625em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# themes.xml
<resources xmlns:tools="http://schemas.android.com/tools">

    <style name="myButton" parent="Widget.Material3.Button">
        <item name="android:textSize">18sp</item>
        <item name="android:textColor">@color/white</item>
        <item name="android:textAllCaps">false</item>
        <item name="backgroundTint">@color/accent</item>
        <item name="cornerRadius">20dp</item>
    </style>

    <style name="otherButton" parent="Widget.Material3.Button">
        <item name="android:textSize">18sp</item>
        <item name="android:textColor">@color/white</item>
        <item name="android:textAllCaps">false</item>
        <item name="backgroundTint">@color/accent</item>
        <item name="cornerRadius">5dp</item>
    </style>

    <!-- Material3 application theme. -->
    <style
        name="AppTheme"
        parent="Theme.Material3.DayNight.NoActionBar">

        <item name="windowActionBar">true</item>
        <item name="windowNoTitle">false</item>

        <!-- Customize your light theme here. -->
        <item name="colorPrimary">@color/primary</item>
        <item name="colorPrimaryVariant">@color/primary_dark</item>
        <item name="colorOnPrimary">@color/white</item>
        <!-- Secondary brand color. -->
        <item name="colorSecondary">@color/accent</item>
        <item name="colorSecondaryVariant">@color/accent</item>
        <item name="colorOnSecondary">@color/white</item>
    </style>

    <style name="MyTheme" parent="AppTheme">
        <item name="materialButtonStyle">@style/myButton</item>
    </style>
    
    <!-- AppCompat application theme. -->
    <style name="MyTheme2" parent="Theme.AppCompat.Light.NoActionBar">
        <item name="windowActionBar">true</item>
        <item name="windowNoTitle">false</item>

        <!-- Customize your light theme here. -->
        <item name="colorPrimary">@color/primary</item>
        <item name="colorPrimaryVariant">@color/primary_dark</item>
        <item name="colorOnPrimary">@color/white</item>
        <!-- Secondary brand color. -->
        <item name="colorSecondary">@color/accent</item>
        <item name="colorSecondaryVariant">@color/accent</item>
        <item name="colorOnSecondary">@color/white</item>

        <item name="materialButtonStyle">@style/otherButton</item>
    </style>
</resources>

# app/src/main/AndroidManifest.xml 
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools">
    <application
        android:allowBackup="true"
        android:dataExtractionRules="@xml/data_extraction_rules"
        android:fullBackupContent="@xml/backup_rules"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/MyTheme2" <!-- 指定主题 -->
        tools:targetApi="31">
        <activity
            android:name=".MainActivity"
            android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
</manifest>

# 单独设置 Activity 的主题
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:theme="@style/MyTheme2" <!-- 指定当前 Activity 主题 -->
    tools:context=".MainActivity">

    ... 
</androidx.constraintlayout.widget.ConstraintLayout>
  ]]>
    </c:sourceContent>


    <c:comment>
      <c:comment1>
        <![CDATA[]]>
      </c:comment1>
    </c:comment>
  </c:entry>


  <c:entry style="margin-top:1em;color:rgb(175, 0, 190);font-size:2.2em;">
    <c:title>Create a Splash Screen in Android studio</c:title>
    <c:desc>
      <c:desc1> <![CDATA[
      
      ]]></c:desc1>
    </c:desc>
    <c:sourceContent type="" title="改变背景色" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/layout/activity_main.xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#fece2f" <!-- 改变背景色 -->
    tools:context=".MainActivity">
    

</androidx.constraintlayout.widget.ConstraintLayout>

  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="导入背景图片" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# 新建5个文件夹
$ mkdir -p ./app/src/main/res/{drawable-hdpi,drawable-mdpi,drawable-xhdpi,drawable-xxhdpi,drawable-xxxhdpi}
  ]]>
    </c:sourceContent>
    <c:sourceContent type="html" title="将以下图片放入各自文件夹中" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
<div style="margin-top:.325em;">
  <img width="450px" src="/images/android/styles-and-themes/img9.png"/>
</div>
<div style="margin-top:.325em;">
  <img width="450px" src="/images/android/styles-and-themes/bulls_rent_logo_white.jpg"/>
</div>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="html" title="设置背景布局" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
<div style="margin-top:.325em;">
  <img width="70%" src="/images/android/styles-and-themes/img10.png"/>
</div>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="html" title="安装并设置字体" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
<div style="margin-top:.625em;">
  下载字体: <a href="/images/android/styles-and-themes/bangers.zip">bangers</a>, <a href="/images/android/styles-and-themes/antic.zip">antic</a>
</div>
<div style="margin-top:.625em;">
  将解压后得到的 <code>bangers.regular.ttf</code>、<code>antic.regular.ttf</code> 字体文件复制到 <code>app/src/main/res/font</code> 文件夹中。<br />
  (去掉文件名的所有 <code>.</code>, 并保留扩展名前面的 <code>.</code>)
</div>
<div style="margin-top:.325em;">
  <img width="70%" src="/images/android/styles-and-themes/img11.png"/>
</div>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# Activity 布局
# app/src/main/res/layout/activity_main.xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#fece2f"
    tools:context=".MainActivity">

    <ImageView
        android:id="@+id/imageView"
        android:layout_width="0dp"
        android:layout_height="275dp"
        android:layout_marginStart="10dp"
        android:layout_marginEnd="10dp"
        android:src="@drawable/bulls_rent_logo_white"
        app:layout_constraintBottom_toTopOf="@+id/textView"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintHorizontal_bias="1.0"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toTopOf="parent" />

    <TextView
        android:id="@+id/textView"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_marginBottom="130dp"
        android:fontFamily="monospace"
        android:text="Bull's Rent"
        android:textAlignment="center"
        android:textSize="40sp"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintHorizontal_bias="0.0"
        app:layout_constraintStart_toStartOf="parent" />

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="10dp"
        android:text="Nation wide Car rental app"
        android:textAlignment="center"
        android:textSize="18sp"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toBottomOf="@+id/textView" />

</androidx.constraintlayout.widget.ConstraintLayout>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="设置全屏显示" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/splashscreen/MainActivity.kt
class MainActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

+        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.R) { 
+            // api 30
+            window.decorView.windowInsetsController!!.hide(
+                WindowInsets.Type.statusBars()
+            )
+        } else {
+            window.setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN)
+        }

        setContentView(R.layout.activity_main)
    }
}
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="设置动画" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1em;line-height:1.3;font-family:monospace;">
                     <![CDATA[

## 新建文件夹
# app/src/main/res/anim

## 新建文件
# app/src/main/res/anim/top_animation.xml
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android">

    <translate
        android:fromXDelta="0%"
        android:fromYDelta="-50%"
        android:duration="2000" />

    <alpha
        android:fromAlpha="0.1"
        android:toAlpha="1.0"
        android:duration="1500" />
</set>

# app/src/main/res/anim/bottom_animation.xml
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android">

    <translate
        android:fromXDelta="0%"
        android:fromYDelta="100%"
        android:duration="1500" />

    <alpha
        android:fromAlpha="0.1"
        android:toAlpha="1.0"
        android:duration="1500" />
</set>

# app/src/main/java/com/android_labs/splashscreen/MainActivity.kt
class MainActivity : AppCompatActivity() {

    private lateinit var topAnim: Animation;
    private lateinit var bottomAnim: Animation;

    private lateinit var image: ImageView
    private lateinit var logo: TextView
    private lateinit var slogan: TextView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.R) {
            window.decorView.windowInsetsController!!.hide(
                WindowInsets.Type.statusBars()
            )
        } else {
            window.setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN)
        }

        setContentView(R.layout.activity_main)

        this.topAnim = AnimationUtils.loadAnimation(this, R.anim.top_animation)
        this.bottomAnim = AnimationUtils.loadAnimation(this, R.anim.bottom_animation)

        this.image = findViewById(R.id.imageView)
        this.logo = findViewById(R.id.textView)
        this.slogan = findViewById(R.id.textView2)
        
        Handler().postDelayed({
            // new activity
            startActivity(Intent(this, HelloActivity::class.java))
            finish();
        }, 2000)
    }
}
  ]]>
    </c:sourceContent>

    <c:comment>
      <c:comment1>
        <![CDATA[]]>
      </c:comment1>
    </c:comment>
  </c:entry>



  <c:entry style="margin-top:1em;color:rgb(175, 0, 190);font-size:2.2em;">
    <c:title>Create a Cryptocurrency app</c:title>
    <c:desc>
      <c:desc1> <![CDATA[
      Resource File: <a href="/images/android/project120.zip">project120.zip</a>
      ]]></c:desc1>
    </c:desc>
    <c:sourceContent type="" title="IntroActivity 布局" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:0em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/layout/activity_intro.xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#130041" <!-- 修改背景色 -->
    tools:context=".MainActivity">

    <ImageView
        android:id="@+id/imageView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintTop_toTopOf="parent"
        app:srcCompat="@drawable/circle_top_splash" />

    <ImageView
        android:id="@+id/imageView2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="20dp"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toTopOf="parent"
        app:srcCompat="@drawable/credit" />

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="The Future"
        android:textAllCaps="true"
        android:textColor="#FFFFFF"
        android:textSize="41sp"
        android:textStyle="bold"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toBottomOf="@+id/imageView2" />

    <TextView
        android:id="@+id/textView2"
        android:layout_width="300dp"
        android:layout_height="wrap_content"
        android:layout_marginTop="8dp"
        android:text="Learn more about cryptocurrency look to the future"
        android:textAlignment="center"
        android:textColor="#ffffff"
        android:textSize="18sp"
        app:layout_constraintEnd_toEndOf="@+id/textView3"
        app:layout_constraintHorizontal_bias="0.508"
        app:layout_constraintStart_toStartOf="@+id/textView3"
        app:layout_constraintTop_toBottomOf="@+id/textView3" />

    <ImageView
        android:id="@+id/imageView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintEnd_toEndOf="@+id/textView2"
        app:layout_constraintStart_toStartOf="@+id/textView2"
        app:layout_constraintTop_toBottomOf="@+id/textView2"
        app:srcCompat="@drawable/intro_button"
        tools:srcCompat="@drawable/intro_button" />

</androidx.constraintlayout.widget.ConstraintLayout>

  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="修改状态栏颜色" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/values/themes.xml
<resources xmlns:tools="http://schemas.android.com/tools">
    <!-- Base application theme. -->
    <style name="Base.Theme.CryptocurrencyApp" parent="Theme.Material3.DayNight.NoActionBar">
        <!-- Customize your light theme here. -->
+        <item name="colorPrimary">#130041</item>
    </style>
</resources>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="新建 LoginActivity" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# 修改 activity_login.xml 背景色
> #130041
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="新建文本框背景样式" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/drawable/edittext_background.xml
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item>
        <shape android:shape="rectangle">
            <corners android:radius="10dp" />
            <solid android:color="#281A56" />
            <stroke android:color="#281A56" android:width="1dp" />
        </shape>
    </item>
</selector>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="新建按钮背景样式" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/drawable/edittext_background.xml
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item>
        <shape android:shape="rectangle">
            <corners android:radius="10dp" />
            <solid android:color="#281A56" />
            <stroke android:color="#281A56" android:width="1dp" />
        </shape>
    </item>
</selector>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="html" title="LoginActivity 页面布局" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
<div style="margin-top:.325em;">
  <img width="50%" src="/images/android/styles-and-themes/img13.png"/>
</div>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/layout/activity_login.xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/primary"
    tools:context=".LoginActivity">

    <TextView
        android:id="@+id/textView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginStart="32dp"
        android:layout_marginTop="128dp"
        android:text="Log in"
        android:textColor="@color/white"
        android:textSize="50sp"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toTopOf="parent" />

    <TextView
        android:id="@+id/textView4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="32dp"
        android:text="User name"
        android:textColor="@color/white"
        android:textSize="20sp"
        app:layout_constraintStart_toStartOf="@+id/textView"
        app:layout_constraintTop_toBottomOf="@+id/textView" />

    <EditText
        android:id="@+id/editTextText"
        android:layout_width="0dp"
        android:layout_height="50dp"
        android:layout_marginTop="16dp"
        android:layout_marginEnd="32dp"
        android:background="@drawable/edittext_background"
        android:ems="10"
        android:inputType="text"
        android:paddingStart="8dp"
        android:paddingEnd="8dp"
        android:text="Name"
        android:textAlignment="viewStart"
        android:textColor="@color/white"
        android:textSize="20sp"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="@+id/textView4"
        app:layout_constraintTop_toBottomOf="@+id/textView4" />

    <TextView
        android:id="@+id/textView5"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_marginTop="32dp"
        android:text="Password"
        android:textColor="@color/white"
        android:textSize="20sp"
        app:layout_constraintStart_toStartOf="@+id/textView"
        app:layout_constraintTop_toBottomOf="@+id/editTextText" />

    <EditText
        android:id="@+id/editTextText2"
        android:layout_width="0dp"
        android:layout_height="50dp"
        android:layout_marginTop="16dp"
        android:layout_marginEnd="32dp"
        android:background="@drawable/edittext_background"
        android:ems="10"
        android:inputType="textPassword"
        android:paddingStart="8dp"
        android:paddingEnd="8dp"
        android:text="Name"
        android:textColor="@color/white"
        android:textSize="20sp"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="@+id/textView"
        app:layout_constraintTop_toBottomOf="@+id/textView5" />

    <TextView
        android:id="@+id/textView6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="16dp"
        android:text="Forget your password"
        android:textColor="@color/white"
        android:textSize="16sp"
        app:layout_constraintEnd_toEndOf="@+id/editTextText2"
        app:layout_constraintStart_toStartOf="@+id/editTextText2"
        app:layout_constraintTop_toBottomOf="@+id/editTextText2" />

    <androidx.appcompat.widget.AppCompatButton
        android:id="@+id/button"
        style="@android:style/Widget.Button"
        android:layout_width="0dp"
        android:layout_height="50dp"
        android:layout_marginTop="64dp"
        android:background="@drawable/button_background"
        android:text="Login"
        android:textColor="@color/white"
        android:textSize="20sp"
        app:layout_constraintEnd_toEndOf="@+id/editTextText2"
        app:layout_constraintStart_toStartOf="@+id/editTextText2"
        app:layout_constraintTop_toBottomOf="@+id/textView6" />

    <TextView
        android:id="@+id/textView7"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="32dp"
        android:text="Don't have an account?"
        android:textColor="@color/white"
        android:textSize="16sp"
        app:layout_constraintEnd_toEndOf="@+id/button"
        app:layout_constraintStart_toStartOf="@+id/button"
        app:layout_constraintTop_toBottomOf="@+id/button" />

    <TextView
        android:id="@+id/textView8"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Register now"
        android:textColor="@color/white"
        android:textSize="16sp"
        app:layout_constraintEnd_toEndOf="@+id/button"
        app:layout_constraintStart_toStartOf="@+id/button"
        tools:layout_editor_absoluteY="667dp" />
</androidx.constraintlayout.widget.ConstraintLayout>

# app/src/main/java/com/android_labs/cryptocurrencyapp/LoginActivity.kt
class LoginActivity : AppCompatActivity() {

    private lateinit var userNameEdit: EditText
    private lateinit var passwordEdit: EditText
    private lateinit var loginButton: AppCompatButton;

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_login)

        this.userNameEdit = findViewById(R.id.user_name_eidt)
        this.passwordEdit = findViewById(R.id.password_edit)
        this.loginButton = findViewById(R.id.login_button)

        this.loginButton.setOnClickListener{ _: View ->
            if (this.userNameEdit.text.trim().isBlank() || this.passwordEdit.text.trim().isBlank()) {
                Toast.makeText(this, "Please fill the login form", Toast.LENGTH_SHORT)
            } else {
                startActivity(Intent(this, MainActivity::class.java))
            }
        }
    }
}

# app/src/main/java/com/android_labs/cryptocurrencyapp/IntroActivity.kt
class IntroActivity : AppCompatActivity() {

    private lateinit var goButton: ImageView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_intro)

        this.goButton = findViewById(R.id.go_button)

        this.goButton.setOnClickListener { _: View ->
            startActivity(Intent(this, LoginActivity::class.java))
        }
    }
}
  ]]>
    </c:sourceContent>
    <c:sourceContent type="html" title="新建 MainActivity" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
<div style="margin-top:.325em;">
  <img width="50%" src="/images/android/styles-and-themes/img14.png"/>
</div>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# 新建 app/src/main/res/drawable/top_background_main_activity.xml 
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item>
        <shape android:shape="rectangle">
            <gradient android:startColor="#5e4edd" android:endColor="#974ebb" android:angle="-45" />
            <corners android:radius="45dp" />
        </shape>
    </item>
</selector>

# 新建 app/src/main/res/drawable/top_button_main.xml 
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item>
        <shape android:shape="rectangle">
            <gradient android:startColor="#5e4edd" android:endColor="#974ebb" android:angle="-45" />
            <corners android:radius="45dp" />
        </shape>
    </item>
</selector>

# 新建 app/src/main/res/drawable/floating_background_main_activity.xml 
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
    <item>
        <shape android:shape="oval">
            <gradient android:angle="45" android:startColor="#974ebd" android:endColor="#5e4edd" />
        </shape>
    </item>
    <item
        android:drawable="@drawable/float_icon"
        android:top="15dp" android:right="15dp" android:left="15dp" android:bottom="15dp">
    </item>
</layer-list>

# 新建 app/src/main/res/values/styles.xml 
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <style name="Floating" parent="Widget.Design.FloatingActionButton">
        <item name="android:background"></item>
    </style>
</resources>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="UserInfoFragment" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/cryptocurrencyapp/UserInfoFragment.kt 
class UserInfoFragment: Fragment() {

    companion object {
        fun newInstance(): UserInfoFragment {
            return UserInfoFragment()
        }
    }

    override fun onCreateView(
        inflater: LayoutInflater,
        container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        return inflater.inflate(R.layout.fragment_user_info, container, false)
    }
}

# app/src/main/res/layout/fragment_user_info.xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_margin="16dp"
    android:background="@drawable/top_background_main_activity">

    <ImageView
        android:id="@+id/imageView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginStart="24dp"
        android:layout_marginTop="24dp"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toTopOf="parent"
        app:srcCompat="@drawable/profile" />

    <TextView
        android:id="@+id/textView9"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginStart="24dp"
        android:text="Pitter"
        android:textColor="@color/white"
        android:textSize="16sp"
        android:textStyle="bold"
        app:layout_constraintBottom_toBottomOf="@+id/imageView3"
        app:layout_constraintStart_toEndOf="@+id/imageView3"
        app:layout_constraintTop_toTopOf="@+id/imageView3" />

    <TextView
        android:id="@+id/textView10"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="16dp"
        android:text="Balance on USDT"
        android:textColor="@color/white"
        android:textSize="16sp"
        android:textStyle="bold"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toBottomOf="@+id/imageView3" />

    <TextView
        android:id="@+id/textView11"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="16dp"
        android:text="$10,548"
        android:textColor="@color/white"
        android:textSize="53dp"
        android:textStyle="bold"
        app:layout_constraintEnd_toEndOf="@+id/textView10"
        app:layout_constraintStart_toStartOf="@+id/textView10"
        app:layout_constraintTop_toBottomOf="@+id/textView10" />

    <TextView
        android:id="@+id/textView12"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text=".00"
        android:textColor="@color/white"
        android:textSize="40sp"
        app:layout_constraintBottom_toBottomOf="@+id/textView11"
        app:layout_constraintStart_toEndOf="@+id/textView11"
        app:layout_constraintTop_toTopOf="@+id/textView11"
        app:layout_constraintVertical_bias="0.82" />

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginStart="4dp"
        android:layout_marginTop="16dp"
        android:layout_marginEnd="4dp"
        android:layout_marginBottom="16dp"
        android:orientation="horizontal"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toBottomOf="@+id/textView11">

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:orientation="vertical">

            <androidx.constraintlayout.widget.ConstraintLayout
                android:layout_width="70dp"
                android:layout_height="70dp"
                android:layout_gravity="center"
                android:layout_margin="4dp"
                android:background="@drawable/top_button_main">

                <ImageView
                    android:id="@+id/add_button"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    app:layout_constraintBottom_toBottomOf="parent"
                    app:layout_constraintEnd_toEndOf="parent"
                    app:layout_constraintStart_toStartOf="parent"
                    app:layout_constraintTop_toTopOf="parent"
                    app:srcCompat="@drawable/add" />
            </androidx.constraintlayout.widget.ConstraintLayout>

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="8dp"
                android:layout_weight="1"
                android:text="Add"
                android:textAlignment="center"
                android:textColor="@color/white"
                android:textSize="18sp" />
        </LinearLayout>

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:orientation="vertical">

            <androidx.constraintlayout.widget.ConstraintLayout
                android:layout_width="70dp"
                android:layout_height="70dp"
                android:layout_gravity="center"
                android:layout_margin="4dp"
                android:background="@drawable/top_button_main">

                <ImageView
                    android:id="@+id/send_button"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    app:layout_constraintBottom_toBottomOf="parent"
                    app:layout_constraintEnd_toEndOf="parent"
                    app:layout_constraintStart_toStartOf="parent"
                    app:layout_constraintTop_toTopOf="parent"
                    app:srcCompat="@drawable/send" />
            </androidx.constraintlayout.widget.ConstraintLayout>

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="8dp"
                android:layout_weight="1"
                android:text="Send"
                android:textAlignment="center"
                android:textColor="@color/white"
                android:textSize="18sp" />
        </LinearLayout>

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:orientation="vertical">

            <androidx.constraintlayout.widget.ConstraintLayout
                android:layout_width="70dp"
                android:layout_height="70dp"
                android:layout_gravity="center"
                android:layout_margin="4dp"
                android:background="@drawable/top_button_main">

                <ImageView
                    android:id="@+id/receive_button"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    app:layout_constraintBottom_toBottomOf="parent"
                    app:layout_constraintEnd_toEndOf="parent"
                    app:layout_constraintStart_toStartOf="parent"
                    app:layout_constraintTop_toTopOf="parent"
                    app:srcCompat="@drawable/receive" />
            </androidx.constraintlayout.widget.ConstraintLayout>

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="8dp"
                android:layout_weight="1"
                android:text="Receive"
                android:textAlignment="center"
                android:textColor="@color/white"
                android:textSize="18sp" />
        </LinearLayout>

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:orientation="vertical">

            <androidx.constraintlayout.widget.ConstraintLayout
                android:layout_width="70dp"
                android:layout_height="70dp"
                android:layout_gravity="center"
                android:layout_margin="4dp"
                android:background="@drawable/top_button_main">

                <ImageView
                    android:id="@+id/buy_button"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    app:layout_constraintBottom_toBottomOf="parent"
                    app:layout_constraintEnd_toEndOf="parent"
                    app:layout_constraintStart_toStartOf="parent"
                    app:layout_constraintTop_toTopOf="parent"
                    app:srcCompat="@drawable/buy" />
            </androidx.constraintlayout.widget.ConstraintLayout>

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_margin="4dp"
                android:layout_marginTop="8dp"
                android:layout_weight="1"
                android:text="Buy"
                android:textAlignment="center"
                android:textColor="@color/white"
                android:textSize="18sp" />
        </LinearLayout>

    </LinearLayout>

</androidx.constraintlayout.widget.ConstraintLayout>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="BalanceListFragment" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/cryptocurrencyapp/BalanceListFragment.kt 
class BalanceListFragment: Fragment() {

    companion object {
        fun newInstance(): BalanceListFragment {
            return BalanceListFragment()
        }
    }

    override fun onCreateView(
        inflater: LayoutInflater,
        container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        return inflater.inflate(R.layout.fragment_balance_list, container, false)
    }
}

#  app/src/main/res/layout/fragment_balance_list.xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/primary"
    android:orientation="vertical">

    <TextView
        android:id="@+id/textView19"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_margin="16dp"
        android:text="Crypto activities"
        android:textAlignment="viewStart"
        android:textColor="@color/white"
        android:textSize="18sp"
        android:textStyle="bold" />

    <androidx.recyclerview.widget.RecyclerView
        android:layout_width="match_parent"
        android:layout_height="match_parent" />
</LinearLayout>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="BottomNavFragment" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/cryptocurrencyapp/BottomNavFragment.kt 
class BottomNavFragment : Fragment() {

    companion object {
        fun newInstance(): BottomNavFragment {
            return BottomNavFragment()
        }
    }

    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?
    ): View? {
        return inflater.inflate(R.layout.fragment_bottom_nav, container, false)
    }
}

# app/src/main/res/layout/fragment_bottom_nav.xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.coordinatorlayout.widget.CoordinatorLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="60dp">

    <com.google.android.material.bottomappbar.BottomAppBar
        android:id="@+id/bottom_nav_bar"
        android:layout_width="match_parent"
        android:layout_height="60dp"
        android:layout_gravity="bottom"
        android:backgroundTint="#37386e"
        app:fabCradleMargin="8dp"
        app:fabCradleRoundedCornerRadius="50dp"
        app:fabCradleVerticalOffset="6dp">

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:orientation="horizontal">

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:paddingTop="4dp"
                android:layout_weight="1"
                android:orientation="vertical">

                <ImageView
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_margin="4dp"
                    android:layout_weight="1"
                    app:srcCompat="@drawable/bottom_btn1" />

                <TextView
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:text="Home"
                    android:textAlignment="center"
                    android:textColor="#9695ce"
                    android:textSize="12sp" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:paddingTop="4dp"
                android:layout_weight="1"
                android:orientation="vertical">

                <ImageView
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_margin="4dp"
                    android:layout_weight="1"
                    app:srcCompat="@drawable/bottom_btn2" />

                <TextView
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:text="Profile"
                    android:textAlignment="center"
                    android:textColor="#9695ce"
                    android:textSize="12sp" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:paddingTop="4dp"
                android:layout_weight="1"
                android:orientation="vertical"
                android:visibility="invisible">

                <ImageView
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_margin="4dp"
                    android:layout_weight="1"
                    app:srcCompat="@drawable/bottom_btn1" />

                <TextView
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:text="Home"
                    android:textAlignment="center"
                    android:textColor="#9695ce"
                    android:textSize="12sp" />

            </LinearLayout>

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:paddingTop="4dp"
                android:layout_weight="1"
                android:orientation="vertical">

                <ImageView
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_margin="4dp"
                    android:layout_weight="1"
                    app:srcCompat="@drawable/bottom_btn3" />

                <TextView
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:text="Wallet"
                    android:textAlignment="center"
                    android:textColor="#9695ce"
                    android:textSize="12sp" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:paddingTop="4dp"
                android:layout_weight="1"
                android:orientation="vertical">

                <ImageView
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_margin="4dp"
                    android:layout_weight="1"
                    app:srcCompat="@drawable/bottom_btn4" />

                <TextView
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:text="Settings"
                    android:textAlignment="center"
                    android:textColor="#9695ce"
                    android:textSize="12sp" />
            </LinearLayout>

        </LinearLayout>

    </com.google.android.material.bottomappbar.BottomAppBar>

    <com.google.android.material.floatingactionbutton.FloatingActionButton
        style="@style/Floating"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:visibility="invisible"
        app:layout_anchor="@+id/bottom_nav_bar"
        app:layout_anchorGravity="top|center"
        app:maxImageSize="30dp" />

</androidx.coordinatorlayout.widget.CoordinatorLayout>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="MainActivity" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/cryptocurrencyapp/MainActivity.kt
class MainActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        if (supportFragmentManager.findFragmentById(R.id.bottom_nav_container) == null) {
            supportFragmentManager.beginTransaction().add(R.id.bottom_nav_container, BottomNavFragment.newInstance()).commit()
        }

        if (supportFragmentManager.findFragmentById(R.id.user_info_container) == null) {
            supportFragmentManager.beginTransaction().add(R.id.user_info_container, UserInfoFragment.newInstance()).commit()
        }

        if (supportFragmentManager.findFragmentById(R.id.balance_list_container) == null) {
            supportFragmentManager.beginTransaction().add(R.id.balance_list_container, BalanceListFragment.newInstance()).commit()
        }
    }
}

# app/src/main/res/layout/activity_main.xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/primary"
    tools:context=".MainActivity">

    <ScrollView
        android:id="@+id/scrollView2"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_marginBottom="60dp"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toTopOf="parent">

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical">

            <FrameLayout
                android:id="@+id/user_info_container"
                android:layout_width="match_parent"
                android:layout_height="wrap_content" />

            <FrameLayout
                android:id="@+id/balance_list_container"
                android:layout_width="match_parent"
                android:layout_height="match_parent" />
        </LinearLayout>
    </ScrollView>

    <FrameLayout
        android:id="@+id/bottom_nav_container"
        android:layout_width="match_parent"
        android:layout_height="60dp"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintHorizontal_bias="0.0"
        app:layout_constraintStart_toStartOf="parent" />

</androidx.constraintlayout.widget.ConstraintLayout>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="BalanceListViewHolder" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/drawable/view_holder_background.xml
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item>
        <shape android:shape="rectangle">
            <solid android:color="@color/primary" />
            <corners android:radius="20dp" />
        </shape>
    </item>
</selector>

# app/src/main/res/layout/view_holder_balance_list.xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="82dp"
    android:layout_marginStart="16dp"
    android:layout_marginTop="4dp"
    android:layout_marginEnd="16dp"
    android:layout_marginBottom="4dp"
    android:background="@drawable/view_holder_background">

    <ImageView
        android:id="@+id/imageView4"
        android:layout_width="40dp"
        android:layout_height="40dp"
        android:layout_marginStart="16dp"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toTopOf="parent"
        app:srcCompat="@drawable/bitcoin" />

    <TextView
        android:id="@+id/textView13"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginStart="8dp"
        android:text="Title"
        android:textColor="@color/white"
        android:textSize="14sp"
        android:textStyle="bold"
        app:layout_constraintStart_toEndOf="@+id/imageView4"
        app:layout_constraintTop_toTopOf="@+id/imageView4" />

    <TextView
        android:id="@+id/textView14"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginStart="8dp"
        android:text="$1000.00"
        android:textColor="@color/white"
        android:textSize="14sp"
        app:layout_constraintBottom_toBottomOf="@+id/imageView4"
        app:layout_constraintStart_toEndOf="@+id/imageView4" />

    <TextView
        android:id="@+id/textView15"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginStart="8dp"
        android:text="+10%"
        android:textColor="#12c737"
        app:layout_constraintBottom_toBottomOf="@+id/textView14"
        app:layout_constraintStart_toEndOf="@+id/textView14"
        app:layout_constraintTop_toBottomOf="@+id/textView13" />

    <TextView
        android:id="@+id/textView16"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginEnd="8dp"
        android:text="0.1984BTC"
        android:textColor="@color/white"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintTop_toTopOf="@+id/textView13" />

    <TextView
        android:id="@+id/textView17"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginEnd="8dp"
        android:text="$12,456"
        android:textColor="@color/white"
        app:layout_constraintBottom_toBottomOf="@+id/textView15"
        app:layout_constraintEnd_toEndOf="parent" />
</androidx.constraintlayout.widget.ConstraintLayout>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="BalanceListViewHolder" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# settings.gradle.kts
pluginManagement {
    repositories {
        google()
        mavenCentral()
        gradlePluginPortal()
    }
}

dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    repositories {
        google()
        mavenCentral()
+        maven { url=uri("https://jitpack.io") }
    }
}

rootProject.name = "Cryptocurrency App"
include(":app")

# app/build.gradle.kts
dependencies {
    
    ...

+    implementation("com.github.majorkik:SparkLineLayout:1.0.1")
+    implementation("com.github.bumptech.glide:glide:4.16.0")

}
  ]]>
    </c:sourceContent>


    <c:sourceContent type="" title="" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/layout/view_holder_balance_list.xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="82dp"
    android:layout_marginStart="16dp"
    android:layout_marginTop="4dp"
    android:layout_marginEnd="16dp"
    android:layout_marginBottom="4dp"
    android:background="@drawable/view_holder_background">

+    <com.majorik.sparklinelibrary.SparkLineLayout
+        android:layout_width="100dp"
+        android:layout_height="80dp"
+        android:layout_marginStart="16dp"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintStart_toEndOf="@+id/textView15"
+        app:layout_constraintTop_toTopOf="parent"
+        app:s_line_color="#fed32c"
+        app:s_line_thickness="2dp"
+        app:s_marker_background_color="#fed32c"
+        app:s_marker_width="8dp">
+    </com.majorik.sparklinelibrary.SparkLineLayout>

</androidx.constraintlayout.widget.ConstraintLayout>
  ]]>
    </c:sourceContent>


    <c:sourceContent type="" title="Token.kt" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/cryptocurrencyapp/Token.kt
class Token (
    var symbol: String = "",
    var price: Double,
    var percent: Double,
    var lineData: ArrayList<Int>,
    var amount: Double,
    var size: Double,
)
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="BalanceListFragment.kt" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:.625em"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/cryptocurrencyapp/BalanceListFragment.kt
package com.android_labs.cryptocurrencyapp

import android.graphics.Color
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ImageView
import android.widget.TextView
import androidx.fragment.app.Fragment
import androidx.recyclerview.widget.LinearLayoutManager
import androidx.recyclerview.widget.RecyclerView
import com.bumptech.glide.Glide
import com.majorik.sparklinelibrary.SparkLineLayout
import java.text.DecimalFormat

class BalanceListFragment : Fragment() {

    companion object {
        fun newInstance(): BalanceListFragment {
            return BalanceListFragment()
        }
    }

    private lateinit var listView: RecyclerView

    override fun onCreateView(
        inflater: LayoutInflater,
        container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        var view = inflater.inflate(R.layout.fragment_balance_list, container, false)

        this.listView = view.findViewById(R.id.list_view)
        this.listView.layoutManager = LinearLayoutManager(context)

        this.listView.adapter = BalanceListAdapter(
            listOf(
                Token("ethereum", "ETH", 1435.0, 1.0, listOf(1, 3, 3, 6,2,7,8), 1.0123, 1.2),
                Token("bitcoin", "BTC", 1435.0, 1.0, listOf(1, 3, 3), 0.0, 1.2),
                Token("ethereum", "USDT", 1435.0, -0.65, listOf(1, 3, 3), 0.0, 1.2),
                Token("trox", "TRX", 1435.0, 1.0, listOf(1, 3, 3), 0.0, 1.2),
                Token("ethereum", "MATIC", 1435.0, 1.0, listOf(1, 3, 3), 0.0, 1.2),
                Token("ethereum", "BNB", 1435.0, 1.0, listOf(1, 3, 3), 0.0, 1.2),
                Token("ethereum", "FIL", 1435.0, 1.0, listOf(1, 3, 3), 0.0, 1.2),
            )
        )

        return view
    }

    private inner class BalanceListHolder(val view: View) : RecyclerView.ViewHolder(view) {

        private var tokenSymbolTxt: TextView = view.findViewById(R.id.textView13)
        private var tokenPriceTxt: TextView = view.findViewById(R.id.textView14)
        private var tokenPercentTxt: TextView = view.findViewById(R.id.textView15)
        private var tokenAmountTxt: TextView = view.findViewById(R.id.textView16)
        private var tokenSizeTxt: TextView = view.findViewById(R.id.textView17)

        private var tokenIcon: ImageView = view.findViewById(R.id.imageView4)
        private var lineChat: SparkLineLayout = view.findViewById(R.id.line_data)

        private val decimalFormatter = DecimalFormat("###,###,###,###.##")

        fun bind(token: Token) {
            this.tokenSymbolTxt.text = token.symbol.uppercase()
            this.tokenPriceTxt.text = decimalFormatter.format(token.price)
            this.tokenAmountTxt.text = "$" + decimalFormatter.format(token.amount)
            this.tokenPercentTxt.text = token.changePercent.toString() + "%"
            this.tokenSizeTxt.text = token.size.toString() + "" + token.symbol.uppercase()
            this.lineChat.setData(ArrayList(token.lineData))

            if (token.changePercent > 0) {
                this.tokenPercentTxt.setTextColor(Color.parseColor("#12c737"))
                this.lineChat.sparkLineColor = Color.parseColor("#12c737")
            } else if (token.changePercent < 0) {
                this.tokenPercentTxt.setTextColor(Color.parseColor("#fc0000"))
                this.lineChat.sparkLineColor = Color.parseColor("#fc0000")
            } else {
                this.tokenPercentTxt.setTextColor(Color.parseColor("#ffffff"))
                this.lineChat.sparkLineColor = Color.parseColor("#ffffff")
            }

            var resourceId = view.context.resources.getIdentifier(token.logo, "drawable", view.context.packageName)
            Glide.with(view.context).load(resourceId).into(tokenIcon)

        }
    }

    private inner class BalanceListAdapter(val balanceList: List<Token>) : RecyclerView.Adapter<BalanceListHolder>() {
        override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): BalanceListHolder {
            return BalanceListHolder(
                layoutInflater.inflate(
                    R.layout.view_holder_balance_list,
                    parent,
                    false
                )
            )
        }

        override fun getItemCount(): Int {
            return balanceList.size
        }

        override fun onBindViewHolder(holder: BalanceListHolder, position: Int) {
            holder.bind(balanceList[position])
        }
    }
}
  ]]>
    </c:sourceContent>


    <c:comment>
      <c:comment1>
        <![CDATA[]]>
      </c:comment1>
    </c:comment>
  </c:entry>


  <c:entry style="margin-top:1em;color:rgb(175, 0, 190);font-size:2.2em;">
    <c:title>QuizApp</c:title>
    <c:desc>
      <c:desc1> <![CDATA[
      
      ]]></c:desc1>
    </c:desc>
    <c:sourceContent type="" title="Makefile" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
### 当前 Makefile 文件物理路径
ROOT_DIR:=$(shell dirname $(realpath $(firstword $(MAKEFILE_LIST))))

build:
  ./gradlew build -x test

tasks:
  ./gradlew tasks

install:
  ./gradlew installDebug

  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="Update app/build.gradle.kts" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# 1. 删除测试文件夹
$ cd QuizApp/
$ rm -rf app/src/androidTest
$ rm -rf app/src/test

# 2. 更新 app/build.gradle.kts
plugins {
    id("com.android.application")
    id("org.jetbrains.kotlin.android")
    id("kotlin-kapt")                                             // +
}

... 

dependencies {
  implementation("androidx.lifecycle:lifecycle-extensions:2.2.0") // +
  implementation("androidx.recyclerview:recyclerview:1.3.2")      // +
  implementation("androidx.room:room-runtime:2.6.1")              // +
  
  kapt("androidx.room:room-compiler:2.6.1")                       // +
}
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="Update strings.xml" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/values/strings.xml
<resources>
    <string name="app_name">QuizApp</string>

    <string name="btn_true_text">True</string>
    <string name="btn_false_text">False</string>
    <string name="btn_prev_text">Prev</string>
    <string name="btn_next_text">Next</string>
    <string name="btn_cheat_text">Cheat!</string>

    <string name="question_australia">1. Canberra is the capital of Australia.</string>
    <string name="question_oceans">2. The Pacific Ocean is larger then the Atlantic Ocean.</string>
    <string name="question_mideast">3. The Suez Canel connects the Red Sea and the Indian Ocean.</string>
    <string name="question_africa">4. The source of the Nile River is in Egypt.</string>
    <string name="question_americas">5. The Amazon River is the longest river in the Americas.</string>
    <string name="question_asia">6. Lake Baikal is the world\'s oldest and deepest freashwater lake.</string>

    <string name="show_answer_warning_text">Are you sure you want to show answer?</string>
    <string name="show_answer_button_text">Show Answer?</string>
</resources>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="Update activity_main.xml" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/layout/activity_main.xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center"
    android:orientation="vertical"
    tools:context=".MainActivity">

    <TextView
        android:id="@+id/field_question_content_tv"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="25sp"
        android:layout_margin="25dp"
        android:text="Hello World!" />

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content">
        <Button
            android:id="@+id/field_true_btn"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_margin="5dp"
            android:text="@string/btn_true_text"/>

        <Button
            android:id="@+id/field_false_btn"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_margin="5dp"
            android:text="@string/btn_false_text"/>
    </LinearLayout>

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content">
        <Button
            android:id="@+id/field_prev_btn"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_margin="5dp"
            android:drawableLeft="@drawable/arrow_left"
            android:text="@string/btn_prev_text"/>

        <Button
            android:id="@+id/field_next_btn"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_margin="5dp"
            android:drawableRight="@drawable/arrow_right"
            android:text="@string/btn_next_text"/>
    </LinearLayout>

    <Button
        android:id="@+id/field_cheat_btn"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_margin="35dp"
        android:text="@string/btn_cheat_text"/>

</LinearLayout>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="Add activity_cheat.xml" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/layout/activity_cheat.xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center"
    android:orientation="vertical">

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_margin="25dp"
        android:textSize="25sp"
        android:text="@string/show_answer_warning_text"/>

    <TextView
        android:id="@+id/field_real_answer_tv"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="35sp"
        tools:text="Answer?"/>

    <Button
        android:id="@+id/field_show_answer_btn"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_margin="35dp"
        android:textSize="25sp"
        android:text="@string/show_answer_button_text"/>

</LinearLayout>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="Add Question.kt (新增模型类)" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/quizapp/Question.kt
package com.android_labs.quizapp

data class Question (
    val textId: Int, val answer: Boolean
)
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="Add QuizViewModel.kt (新增视图类)" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/quizapp/QuizViewModel.kt
package com.android_labs.quizapp

import androidx.lifecycle.ViewModel

class QuizViewModel: ViewModel() {

    var isCheat: Boolean = false

    private val questionList = listOf(
        Question(R.string.question_australia, true),
        Question(R.string.question_oceans, true),
        Question(R.string.question_mideast, false),
        Question(R.string.question_africa, false),
        Question(R.string.question_americas, true),
        Question(R.string.question_asia, true),
    )

    private var currentIndex = 0

    fun incrementIndex(step: Int): Int {
        this.currentIndex = if (this.currentIndex + step < 0) {
            this.questionList.size - 1
        } else {
            (this.currentIndex + step) % this.questionList.size
        }

        return this.questionList[this.currentIndex].textId
    }

    val currentAnswer: Boolean
        get() = this.questionList[this.currentIndex].answer
}
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="新增 CheatActivity.kt" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/quizapp/CheatActivity.kt
package com.android_labs.quizapp

import android.app.Activity
import android.content.Context
import android.content.Intent
import android.os.Bundle
import android.os.PersistableBundle
import android.view.View
import android.widget.Button
import android.widget.TextView
import androidx.appcompat.app.AppCompatActivity

const val EXTRA_KEY_ANSWER_SHOWED = "com.android_labs.quizapp::ANSWER_SHOWED"

private const val EXTRA_KEY_REAL_ANSWER = "com.android_labs.quizapp::REAL_ANSWER"

class CheatActivity: AppCompatActivity() {

    companion object {
        fun newIntent(context: Context, realAnswer: Boolean): Intent {
            // 接收 Intent 参数
            return Intent(context, CheatActivity::class.java).apply {
                putExtra(EXTRA_KEY_REAL_ANSWER, realAnswer)
            }
        }
    }

    private lateinit var fieldRealAnswerTv: TextView
    private lateinit var fieldShowAnswerBtn: Button

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_cheat)

        this.fieldRealAnswerTv = findViewById(R.id.field_real_answer_tv)
        this.fieldShowAnswerBtn = findViewById(R.id.field_show_answer_btn)

        // 读取 Intent 参数
        val realAnswer = intent.getBooleanExtra(EXTRA_KEY_REAL_ANSWER, false)

        this.fieldShowAnswerBtn.setOnClickListener{_: View ->
            this.fieldRealAnswerTv.setText(if (realAnswer) {
                R.string.btn_true_text
            } else {
                R.string.btn_false_text
            })

            // 返回 Intent 参数
            setResult(Activity.RESULT_OK, intent.apply {
                putExtra(EXTRA_KEY_ANSWER_SHOWED, true)
            })
        }
    }

}
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="更新 AndroidManifest.xml" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/AndroidManifest.xml
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools">

    <application
        android:allowBackup="true"
        android:dataExtractionRules="@xml/data_extraction_rules"
        android:fullBackupContent="@xml/backup_rules"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/Theme.QuizApp"
        tools:targetApi="31">
        <activity android:name=".CheatActivity"/> <!-- 新增 Activity 后需更新 AndroidManifest.xml -->
        <activity
            android:name=".MainActivity"
            android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="更新 MainActivity.kt" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/quizapp/MainActivity.kt
package com.android_labs.quizapp

import android.app.ActivityOptions
import android.content.Intent
import android.os.Build
import androidx.appcompat.app.AppCompatActivity
import android.os.Bundle
import android.view.View
import android.widget.Button
import android.widget.TextView
import android.widget.Toast
import androidx.lifecycle.ViewModelProvider

private const val REQUEST_CODE_CHEAT = 0

class MainActivity : AppCompatActivity() {

    private lateinit var fieldQuestionContentTv: TextView
    private lateinit var fieldTrueBtn: Button
    private lateinit var fieldFalseBtn: Button
    private lateinit var fieldPrevBtn: Button
    private lateinit var fieldNextBtn: Button
    private lateinit var fieldCheatBtn: Button

    // 关联视图状态
    private val quizViewModel: QuizViewModel by lazy {
        ViewModelProvider(this)[QuizViewModel::class.java]
    }

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        this.fieldQuestionContentTv = findViewById(R.id.field_question_content_tv)
        this.fieldTrueBtn = findViewById(R.id.field_true_btn)
        this.fieldFalseBtn = findViewById(R.id.field_false_btn)
        this.fieldPrevBtn = findViewById(R.id.field_prev_btn)
        this.fieldNextBtn = findViewById(R.id.field_next_btn)
        this.fieldCheatBtn = findViewById(R.id.field_cheat_btn)

        incrementIndex(0)

        this.fieldCheatBtn.setOnClickListener { view: View ->

            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M) {
                startActivityForResult(
                    CheatActivity.newIntent(
                        this,
                        this.quizViewModel.currentAnswer
                    ),
                    REQUEST_CODE_CHEAT,
                    ActivityOptions.makeClipRevealAnimation(
                        view, 0, 0, view.width, view.height
                    ).toBundle()
                )
            } else {
                // 通过 Intent 调起 activity
                startActivityForResult(
                    CheatActivity.newIntent(
                        this,
                        this.quizViewModel.currentAnswer
                    ), REQUEST_CODE_CHEAT
                )
            }
        }

        this.fieldNextBtn.setOnClickListener { _: View ->
            incrementIndex(1)
        }

        this.fieldPrevBtn.setOnClickListener { _: View ->
            incrementIndex(-1)
        }

        this.fieldTrueBtn.setOnClickListener { _: View ->
            checkAnswer(true)
        }

        this.fieldFalseBtn.setOnClickListener { _: View ->
            checkAnswer(false)
        }
    }

    private fun checkAnswer(userAnswer: Boolean) {
        val result = if (userAnswer == this.quizViewModel.currentAnswer) {
            "Correct"
        } else {
            "Incorrect"
        }

        Toast.makeText(
            this, result + if (this.quizViewModel.isCheat) {
                " isCheat"
            } else {
                ""
            }, Toast.LENGTH_SHORT
        ).show()
    }

    private fun incrementIndex(step: Int) {
        this.fieldQuestionContentTv.setText(this.quizViewModel.incrementIndex((step)))
    }

    // 响应 CheatActivity 参数
    override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {
        super.onActivityResult(requestCode, resultCode, data)

        if (resultCode != RESULT_OK) {
            return
        }

        if (requestCode == REQUEST_CODE_CHEAT) {
            this.quizViewModel.isCheat = true
        }
    }
}
  ]]>
    </c:sourceContent>

    <c:comment>
      <c:comment1>
        <![CDATA[]]>
      </c:comment1>
    </c:comment>
  </c:entry>



  <c:entry style="margin-top:1em;color:rgb(175, 0, 190);font-size:2.2em;">
    <c:title>CriminalApp</c:title>
    <c:desc>
      <c:desc1> <![CDATA[
      
      ]]></c:desc1>
    </c:desc>
    <c:sourceContent type="" title="更新 build.gradle.kts" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:0em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# 1. 删除测试文件夹
$ cd QuizApp/
$ rm -rf app/src/androidTest
$ rm -rf app/src/test

# 2. 更新 app/build.gradle.kts
plugins {
    id("com.android.application")
    id("org.jetbrains.kotlin.android")
    id("kotlin-kapt")                                             // +
}

... 

dependencies {
  implementation("androidx.lifecycle:lifecycle-extensions:2.2.0") // +
  implementation("androidx.recyclerview:recyclerview:1.3.2")      // +
  implementation("androidx.room:room-runtime:2.6.1")              // +
  
  kapt("androidx.room:room-compiler:2.6.1")                       // +
}
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="更新 strings.xml" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:0em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/values/strings.xml
<resources>
    <string name="app_name">Criminal09IntentSend</string>

    <string name="crime_title_hint">Enter a title for the crime.</string>
    <string name="crime_title_label">Title</string>
    <string name="crime_details_label">Details</string>
    <string name="crime_solved_label">Solved</string>

    <string name="new_crime">New Crime</string>
    <string name="crime_suspect_text">Choose Suspect</string>
    <string name="crime_report_text">Send Crime Report</string>
    <string name="crime_report">%1$s!
        The crime was discovered on %2$s. %3$s, and %4$s
    </string>
    <string name="crime_report_solved">The case is solved</string>
    <string name="crime_report_unsolved">The case is not solved</string>
    <string name="crime_report_no_suspect">there is no suspect.</string>
    <string name="crime_report_suspect">the suspect is %s.</string>
    <string name="crime_report_subject">CriminalIntent Crime Report</string>
    <string name="send_report">Send crime report via</string>
</resources>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="新增 DatePickerFragment.kt" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/criminal09intentsend/DatePickerFragment.kt
package com.android_labs.criminal09intentsend

import android.app.DatePickerDialog
import android.app.Dialog
import android.os.Bundle
import androidx.fragment.app.DialogFragment
import androidx.fragment.app.Fragment
import java.text.SimpleDateFormat
import java.util.Calendar
import java.util.Date
import java.util.GregorianCalendar

private const val ARG_CURRENT_DATE = "com.android_labs.criminal09intentsend::current_date"

class DatePickerFragment : DialogFragment() {
  
    // 定义回调函数, 用于传递选择的日期
    interface Callbacks {
        fun onDateSelected(date: String)
    }

    companion object {
        fun newInstance(date: String): DatePickerFragment {
            // Fragment: 接收 Bundle 参数
            return DatePickerFragment().apply {
                arguments = Bundle().apply {
                    putSerializable(ARG_CURRENT_DATE, fromDateString(date))
                }
            }
        }

        fun toDateString(date: Date): String {
            return SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(date)
        }

        fun fromDateString(date: String): Date {
            return SimpleDateFormat("yyyy-MM-dd HH:mm:ss").parse(date)
        }
    }

    override fun onCreateDialog(savedInstanceState: Bundle?): Dialog {
        // 监听 Dialog 事件
        val listener = DatePickerDialog.OnDateSetListener { _, year, month, dayOfMonth ->
            // Fragment: 返回参数
            targetFragment?.let { fragment: Fragment ->
                var date = GregorianCalendar(year, month, dayOfMonth).time
                (fragment as Callbacks).onDateSelected(toDateString(date))
            }
        }

        val calendar = Calendar.getInstance()


        // Fragment: 读取 Bundle 参数
        arguments?.let {
            calendar.time = it.getSerializable(ARG_CURRENT_DATE) as Date
        }

        val year = calendar.get(Calendar.YEAR)
        val month = calendar.get(Calendar.MONTH)
        val day = calendar.get(Calendar.DAY_OF_MONTH)

        return DatePickerDialog(
            requireContext(), listener, year, month, day
        )
    }
}
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="新增 fragment_crime_create.xml" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/layout/fragment_crime_create.xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/crime_title_label"/>

    <EditText
        android:id="@+id/field_crime_title_et"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/crime_title_hint"/>

    <TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/crime_details_label"/>

    <Button
        android:id="@+id/field_crime_date_btn"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="2024 01 01"/>

    <CheckBox
        android:id="@+id/field_crime_is_solved_cbx"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/crime_solved_label"/>

    <Button
        android:id="@+id/btn_choose_suspect"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="right"
        android:layout_marginTop="35dp"
        android:textAllCaps="true"
        android:text="@string/crime_suspect_text" />

    <Button
        android:id="@+id/btn_send_report_message"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="right"
        android:textAllCaps="true"
        android:text="@string/crime_report_text" />

</LinearLayout>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="新增 CrimeCreateFragment.kt" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/criminal09intentsend/CrimeCreateFragment.kt
package com.android_labs.criminal09intentsend

import android.app.Activity
import android.content.Intent
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.Button
import android.widget.CheckBox
import android.widget.EditText
import androidx.fragment.app.Fragment
import java.util.Date
import android.provider.ContactsContract

private const val DATE_PICKER_TAG = "com.android_labs.criminal09intentsend::date_picker_tag"
private const val DATE_PICKER_CODE = 0
private const val CHOOSE_CONTRACT_CODE = 1

class CrimeCreateFragment : Fragment(), DatePickerFragment.Callbacks {

    private lateinit var fieldCrimeTitleEt: EditText
    private lateinit var fieldCrimeDateBtn: Button
    private lateinit var fieldCrimeIsSolvedCbx: CheckBox

    private lateinit var btnChooseSuspect: Button
    private lateinit var btnSendReport: Button

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    override fun onCreateView(
        inflater: LayoutInflater,
        container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_crime_create, container, false)

        this.fieldCrimeTitleEt = view.findViewById(R.id.field_crime_title_et)
        this.fieldCrimeDateBtn = view.findViewById(R.id.field_crime_date_btn)
        this.fieldCrimeIsSolvedCbx = view.findViewById(R.id.field_crime_is_solved_cbx)

        this.btnChooseSuspect = view.findViewById(R.id.btn_choose_suspect)
        this.btnSendReport = view.findViewById(R.id.btn_send_report_message)
        this.fieldCrimeDateBtn.text = DatePickerFragment.toDateString(Date())

        return view
    }

    override fun onStart() {
        super.onStart()
    }

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        // 显示日期控件
        this.fieldCrimeDateBtn.setOnClickListener { _: View ->
            DatePickerFragment.newInstance(getCrimeDate()).apply {
                // 关联回调函数
                setTargetFragment(this@CrimeCreateFragment, DATE_PICKER_CODE)
                show(this@CrimeCreateFragment.requireFragmentManager(), DATE_PICKER_TAG)
            }
        }

        // 发送消息(隐式Intent)
        this.btnSendReport.setOnClickListener { _: View ->
            Intent(Intent.ACTION_SEND).apply {
                type = "text/plain"
                putExtra(Intent.EXTRA_SUBJECT, getString(R.string.crime_report_subject))
                putExtra(Intent.EXTRA_TEXT, getCrimeReport())
            }.also { intent ->
                startActivity(intent)
            }
        }

        // 选择联系人(隐式Intent)
        this.btnChooseSuspect.apply {
            val intent = Intent(Intent.ACTION_PICK, ContactsContract.Contacts.CONTENT_URI)

            // intent.addCategory(Intent.CATEGORY_HOME) // 调试用

            setOnClickListener { _: View ->
                startActivityForResult(intent, CHOOSE_CONTRACT_CODE)
            }

            // 检查当前应用是否安装了联系人应用
            var packageManager: PackageManager = requireActivity().packageManager
            var resolvedActivity: ResolveInfo? = packageManager.resolveActivity(intent, PackageManager.MATCH_DEFAULT_ONLY)

            if (resolvedActivity == null) {
                isEnabled = false // 将当前按钮禁用
            }
        }
    }

    private fun getCrimeDate(): String {
        return this.fieldCrimeDateBtn.text.toString()
    }

    // 日期控件回调函数
    override fun onDateSelected(date: String) {
        this.fieldCrimeDateBtn.text = date
    }

    private fun getCrimeReport(): String {
        val solvedString = if (this.fieldCrimeIsSolvedCbx.isChecked) {
            getString(R.string.crime_report_solved)
        } else {
            getString(R.string.crime_report_unsolved)
        }

        val dateString = this.fieldCrimeDateBtn.text.toString()

        val suspect = if (crime.suspect.isBlank()) {
            getString(R.string.crime_report_no_suspect)
        } else {
            getString(R.string.crime_report_suspect, crime.suspect)
        }

        return getString(
            R.string.crime_report,
            this.fieldCrimeTitleEt.text.toString(), dateString, solvedString, suspect
        )
    }

    override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {
        super.onActivityResult(requestCode, resultCode, data)

        when {
            resultCode != Activity.RESULT_OK -> {
                return
            }

            requestCode == CHOOSE_CONTRACT_CODE && data != null -> {
                // 取得联系人名字
                var contactUri: Uri? = data.data
                var queryFields = arrayOf(ContactsContract.Contacts.DISPLAY_NAME)
                var cursor = requireActivity().contentResolver.query(contactUri, queryFields, null, null, null)

                cursor?.use {
                    if (it.count == 0) {
                        return
                    }

                    it.moveToFirst()

                    this.btnChooseSuspect.text = it.getString(0) // 联系人名字
                }
            }
        }
    }
}
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="新增 CrimeEntity.kt" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/criminal04room/CrimeEntity.kt
package com.android_labs.criminal04room

import androidx.room.Entity
import androidx.room.PrimaryKey
import java.util.Date
import java.util.UUID

@Entity(tableName = "Crime")
data class CrimeEntity (
    @PrimaryKey val id: UUID = UUID.randomUUID(),
    var title: String = "",
    var date: Date = Date(),
    var isSolved: Boolean = false
)
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="新增 CrimeTypeConvertor.kt" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/criminal04room/CrimeTypeConvertor.kt
package com.android_labs.criminal04room

import androidx.room.TypeConverter
import java.util.Date
import java.util.UUID

class CrimeTypeConvertor {

    @TypeConverter
    fun toUUID(uuid: String?) : UUID? {
        return uuid?.let {
            UUID.fromString(uuid)
        }
    }

    @TypeConverter
    fun fromUUID(uuid: UUID?): String? {
        return uuid?.toString()
    }

    @TypeConverter
    fun toDate(date: Long?): Date? {
        return date?.let {
            Date(date)
        }
    }

    @TypeConverter
    fun fromDate(date: Date?): Long? {
        return date?.time
    }
}
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="新增 CrimeDao.kt" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/criminal04room/CrimeDao.kt
package com.android_labs.criminal04room

import androidx.lifecycle.LiveData
import androidx.room.Dao
import androidx.room.Query
import java.util.UUID

@Dao
interface CrimeDao {

    @Query("select * from Crime")
    fun queryCrimeList(): LiveData<List<CrimeEntity>>

    @Query("select * from Crime where id=(:id)")
    fun getCrimeById(id: UUID): LiveData<CrimeEntity>
}
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="新增 CrimeDatabase.kt" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/criminal04room/CrimeDatabase.kt
package com.android_labs.criminal04room

import androidx.room.Database
import androidx.room.RoomDatabase
import androidx.room.TypeConverters

@Database(entities = [CrimeEntity::class], version = 1)
@TypeConverters(CrimeTypeConvertor::class)
abstract class CrimeDatabase: RoomDatabase() {

    abstract fun crimeDao(): CrimeDao
}
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="新增 CrimeRepository.kt" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
package com.android_labs.criminal04room

import android.content.Context
import androidx.lifecycle.LiveData
import androidx.room.Room
import java.lang.IllegalStateException
import java.util.UUID

private const val CRIME_DATABASE_NAME = "crime-database"

class CrimeRepository private constructor(context: Context) {

    private val database =
        Room.databaseBuilder(context, CrimeDatabase::class.java, CRIME_DATABASE_NAME).build()

    private val crimeDao = database.crimeDao()

    fun queryCrimeList(): LiveData<List<CrimeEntity>> {
        return crimeDao.queryCrimeList()
    }

    fun getCrimeById(id: UUID): LiveData<CrimeEntity> {
        return crimeDao.getCrimeById(id)
    }

    companion object {
        private var INSTANCE: CrimeRepository? = null

        fun initialized(context: Context) {
            if (INSTANCE == null) {
                INSTANCE = CrimeRepository(context)
            }
        }

        fun get(): CrimeRepository {
            return INSTANCE ?: throw IllegalStateException("CrimeRepository must be initialized")
        }
    }
}
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="新增 CriminalApplication.kt" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
package com.android_labs.criminal04room

import android.app.Application

class CriminalApplication: Application() {

    override fun onCreate() {
        super.onCreate()
        CrimeRepository.initialized(this)
    }
}
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="更新 AndroidManifest.xml" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/AndroidManifest.xml
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools">

    <application
        android:name=".CriminalApplication" <!-- 设置应用程序主类 -->
        android:allowBackup="true"
        android:dataExtractionRules="@xml/data_extraction_rules"
        android:fullBackupContent="@xml/backup_rules"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/Theme.QuizApp"
        tools:targetApi="31">
        <activity
            android:name=".MainActivity"
            android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="新增 fragment_crime_list.xml" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/layout/fragment_crime_list.xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.recyclerview.widget.RecyclerView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:id="@+id/crime_list_view">

</androidx.recyclerview.widget.RecyclerView>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="新增 CrimeViewModel.kt" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/criminal04room/CrimeViewModel.kt
package com.android_labs.criminal04room

import androidx.lifecycle.ViewModel

class CrimeViewModel: ViewModel() {
    var crimeRepository = CrimeRepository.get()
    var crimeList = crimeRepository.queryCrimeList()
}
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="新增 CrimeListFragment.kt" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/criminal04room/CrimeListFragment.kt
package com.android_labs.criminal04room

import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ImageView
import android.widget.TextView
import androidx.fragment.app.Fragment
import androidx.lifecycle.Observer
import androidx.lifecycle.ViewModelProvider
import androidx.recyclerview.widget.LinearLayoutManager
import androidx.recyclerview.widget.RecyclerView

class CrimeListFragment : Fragment() {

    companion object {
        fun newInstance(): CrimeListFragment {
            return CrimeListFragment()
        }
    }

    interface Callbacks {
        fun onCrimeSelected(crimeId: UUID)
    }

    private var callbacks: Callbacks? = null

    private val crimeViewModel: CrimeViewModel by lazy {
        ViewModelProvider(this)[CrimeViewModel::class.java]
    }

    private lateinit var crimeListView: RecyclerView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    override fun onCreateView(
        inflater: LayoutInflater,
        container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_crime_list, container, false)

        this.crimeListView = view.findViewById(R.id.crime_list_view)
        this.crimeListView.layoutManager = LinearLayoutManager(context)
        this.crimeListView.adapter = CrimeListAdapter(emptyList())

        return view
    }

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        this.crimeViewModel.crimeList.observe(viewLifecycleOwner, Observer { crimes ->
            this.crimeListView.adapter = CrimeListAdapter(crimes)
        })
    }

    override fun onStart() {
        super.onStart()
    }

    override fun onAttach(context: Context) {
        super.onAttach(context)
        this.callbacks = context as Callbacks
    }

    override fun onDetach() {
        super.onDetach()
        this.callbacks = null
    }

    private inner class CrimeListHolder(val view: View) : RecyclerView.ViewHolder(view) {

        private lateinit var currCrime: CrimeEntity

        private val crimeTitle = view.findViewById<TextView>(R.id.crime_title_field)
        private val crimeDate = view.findViewById<TextView>(R.id.crime_date_field)
        private val crimeIsSolved = view.findViewById<ImageView>(R.id.crime_solved_field)

        init {
            view.setOnClickListener(this)
        }

        fun bind(crime: CrimeEntity) {
            this.crimeTitle.text = crime.title
            this.crimeDate.text = crime.date.toString()

            this.crimeIsSolved.visibility = if (crime.isSolved) {
                View.VISIBLE
            } else {
                View.GONE
            }
        }

        override fun onClick(v: View?) {
            // 显示详情
            callbacks?.onCrimeSelected(this.currCrime.id)
        }
    }

    private inner class CrimeListAdapter(val crimeList: List<CrimeEntity>) :
        RecyclerView.Adapter<CrimeListHolder>() {
        override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): CrimeListHolder {
            return CrimeListHolder(
                layoutInflater.inflate(
                    R.layout.fragment_crime_list_item,
                    parent,
                    false
                )
            )
        }

        override fun getItemCount(): Int {
            return crimeList.size
        }

        override fun onBindViewHolder(holder: CrimeListHolder, position: Int) {
            holder.bind(this.crimeList[position])
        }
    }
}
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="更新 MainActivity.kt" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/criminal04room/MainActivity.kt
package com.android_labs.criminal04room

import androidx.appcompat.app.AppCompatActivity
import android.os.Bundle

class MainActivity : AppCompatActivity(), CrimeListFragment.Callbacks  {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        if (supportFragmentManager.findFragmentById(R.id.fragment_container) == null) {
            supportFragmentManager.beginTransaction().add(R.id.fragment_container, CrimeListFragment.newInstance()).commit()
        }
    }

    override fun onCrimeSelected(crimeId: UUID) {
        supportFragmentManager.beginTransaction()
            .replace(R.id.fragment_container, CrimeCreateFragment.newInstance(crimeId))
            .addToBackStack(null).commit()
    }
}
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="增加 ActionBar" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
#  app/src/main/res/values/themes.xml
<resources xmlns:tools="http://schemas.android.com/tools">
    <!-- Base application theme. -->
    <style name="Base.Theme.BeatBox" parent="Theme.Material3.DayNight.NoActionBar">
        <!-- Customize your light theme here. -->
        <!-- <item name="colorPrimary">@color/my_light_primary</item> -->
+        <item name="windowActionBar">true</item>
+        <item name="windowNoTitle">false</item>
    </style>

    <style name="Theme.BeatBox" parent="Base.Theme.BeatBox" />

    <style name="BeatBoxButton">
        <item name="android:background">@color/dark_blue</item>
    </style>
</resources>

# app/src/main/res/menu/fragment_crime_list_menu.xml
<?xml version="1.0" encoding="utf-8"?>
<menu
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto">
    <item
        android:id="@+id/new_crime"
        android:title="@string/new_crime"
        android:icon="@android:drawable/ic_menu_add"
        app:showAsAction="ifRoom|withText"/>
</menu>

# app/src/main/java/com/android_labs/criminal04room/CrimeListFragment.kt
override fun onCreate(savedInstanceState: Bundle?) {
    super.onCreate(savedInstanceState)
    
+    setHasOptionsMenu(true)
    
    arguments?.getSerializable(ARG_CRIME_ID).let {
        crimeDetailsViewModel.loadCrime(it as UUID)
    }
}


override fun onCreateOptionsMenu(menu: Menu, inflater: MenuInflater) {
    super.onCreateOptionsMenu(menu, inflater)
    inflater.inflate(R.menu.fragment_crime_list_menu, menu)
}


override fun onOptionsItemSelected(item: MenuItem): Boolean {
    when (item.itemId) {
        R.id.new_crime -> {
            var crime = CrimeEntity()
            callbacks?.onCrimeSelected(crime.id)
            return true
        } else -> {
            return super.onOptionsItemSelected(item)
        }
    }
}
]]>
    </c:sourceContent>

    <c:sourceContent type="" title="增加 suspect 字段" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/criminal04room/CrimeEntity.kt
package com.android_labs.criminal04room

import androidx.room.Entity
import androidx.room.PrimaryKey
import java.util.Date
import java.util.UUID

@Entity(tableName = "Crime")
data class CrimeEntity (
    @PrimaryKey val id: UUID = UUID.randomUUID(),
    var title: String = "",
    var suspect: String = "",                       // +
    var date: Date = Date(),
    var isSolved: Boolean = false
)
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="增加 migration_1_2" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/criminal04room/CrimeDatabase.kt
package com.android_labs.criminal04room

import androidx.room.Database
import androidx.room.RoomDatabase
import androidx.room.TypeConverters

- @Database(entities = [CrimeEntity::class], version = 1)
+ @Database(entities = [CrimeEntity::class], version = 2)
@TypeConverters(CrimeTypeConvertor::class)
abstract class CrimeDatabase: RoomDatabase() {
    abstract fun crimeDao(): CrimeDao
}

+ var migration_1_2 = object: Migration(1, 2) {
+     override fun migrate(database: SupportSQLiteDatabase) {
+         database.execSQL(
+             "alter table Crime add column suspect text not null default ''"
+         )
+     }
+ }
  ]]>
    </c:sourceContent>


    <c:sourceContent type="" title="更新 CrimeRepository.kt" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/criminal04room/CrimeRepository.kt
package com.android_labs.criminal04room

import android.content.Context
import androidx.lifecycle.LiveData
import androidx.room.Room
import java.lang.IllegalStateException
import java.util.UUID

private const val CRIME_DATABASE_NAME = "crime-database"

class CrimeRepository private constructor(context: Context) {

    private val database =
        Room
        .databaseBuilder(context, CrimeDatabase::class.java, CRIME_DATABASE_NAME)
+        .addMigrations(migration_1_2)
        .build()

}
  ]]>
    </c:sourceContent>


    <c:sourceContent type="" title="使用 Intent 拍照" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1em;font-family:monospace;">
                     <![CDATA[
// 更新
// # app/src/main/res/layout/fragment_crime_create.xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:layout_marginStart="5dp"
        android:layout_marginTop="5dp">
        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="vertical">
            <ImageView
                android:id="@+id/crime_photo"
                android:layout_width="80dp"
                android:layout_height="80dp"
                android:scaleType="centerInside"
                android:cropToPadding="true"
                android:background="@android:color/darker_gray"/>

            <ImageButton
                android:id="@+id/crime_camera"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:src="@android:drawable/ic_menu_camera"/>
        </LinearLayout>

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginStart="5dp"
            android:layout_marginEnd="5dp"
            android:layout_weight="1"
            android:orientation="vertical">

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="@string/crime_title_label"/>

            <EditText
                android:id="@+id/field_crime_title_et"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="@string/crime_title_hint"/>

        </LinearLayout>

    </LinearLayout>

    <TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/crime_details_label"/>

    <Button
        android:id="@+id/field_crime_date_btn"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        tools:text="2013 01 01"/>

    <CheckBox
        android:id="@+id/field_crime_is_solved_btn"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/crime_solved_label"/>

    <Button
        android:id="@+id/btn_choose_suspect"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="right"
        android:layout_marginTop="35dp"
        android:textAllCaps="true"
        android:text="@string/crime_suspect_text" />

    <Button
        android:id="@+id/btn_send_report_message"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="right"
        android:textAllCaps="true"
        android:text="@string/crime_report_text" />

</LinearLayout>

# app/src/main/java/com/android_labs/criminal10intent/CrimeCreateFragment.kt
private lateinit var crimePhotoView: ImageView
private lateinit var crimePhotoCamera: Camera

# app/src/main/res/xml/files.xml
<?xml version="1.0" encoding="utf-8"?>
<paths>
    <!-- 将私有空间的跟路径映射为 crime_photos -->
    <files-path name="crime_photos" path="." />
</paths>

# app/src/main/AndroidManifest.xml
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools">

+    <uses-feature android:name="android.hardware.camera" android:required="false" />

    <application>
        .......
+        <provider
+            android:name="androidx.core.content.FileProvider"
+            <!-- 将 FileProvider 和指定的位置关联起来, 相当于你给发出请求的其他应用一个目标地 -->
+            android:authorities="com.android_labs.criminal10intent.fileprovider"
+            <!-- 除了你自己以及你授权的人，其他任何人都不允许使用你的 FileProvider -->
+            android:exported="false"
+            <!-- 用来给其他应用授权，允许他们向你指定位置的 URL -->
+            android:grantUriPermissions="true">
+        </provider>
    </application>
</manifest>

# app/src/main/java/com/android_labs/criminal10intent/CrimeEntity.kt
@Entity(tableName = "Crime")
data class CrimeEntity(
    @PrimaryKey var id: UUID = UUID.randomUUID(),
    var title: String = "",
    var suspect: String = "",
    var date: Date = Date(),
    var isSolved: Boolean = false
) 
+ {
+     val photoFileName
+         get() = "IMG_$id.jpg"
+ }

# app/src/main/java/com/android_labs/criminal10intent/CrimeRepository.kt
+    private val filesDir = context.applicationContext.filesDir
+    fun getPhotoFile(crime: CrimeEntity): File = File(filesDir, crime.photoFileName)

# app/src/main/java/com/android_labs/criminal10intent/CrimeDetailsViewModel.kt
+    fun getPhotoFile(crime: CrimeEntity): File {
+        return crimeRepository.getPhotoFile(crime)
+    }

# app/src/main/java/com/android_labs/criminal10intent/CrimeCreateFragment.kt
+    private lateinit var photoFile: File
+    private lateinit var photoUri: Uri

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        this.crimeDetailsViewModel.crimeLiveData.observe(viewLifecycleOwner, Observer { crime ->
            crime?.let {
                ...
+                this.photoFile = crimeDetailsViewModel.getPhotoFile(it)
                 // 将本地文件路径转成相机能够使用的 Uri 形式
+                this.photoUri = FileProvider.getUriForFile(
+                    requireActivity(), "com.android_labs.criminal10intent.fileprovider", photoFile
+                )
            }
        })
    }

    override fun onStart() {
        super.onStart()
 
+        this.crimePhotoCamera.apply {
+            val packageManager: PackageManager = requireActivity().packageManager
+            val captureImage = Intent(MediaStore.ACTION_IMAGE_CAPTURE)
+            // captureImage.addCategory(Intent.CATEGORY_HOME) // 调试用
+            
+            val resolvedActivity: ResolveInfo? =
+                packageManager.resolveActivity(captureImage, PackageManager.MATCH_DEFAULT_ONLY)
+
+            if (resolvedActivity == null) {
+                isEnabled = false
+            }
+
+            setOnClickListener { _: View ->
+                captureImage.putExtra(MediaStore.EXTRA_OUTPUT, photoUri)
+
+                val cameraActivities: List<ResolveInfo> = packageManager.queryIntentActivities(
+                    captureImage,
+                    PackageManager.MATCH_DEFAULT_ONLY
+                )
+
+                for (cameraActivity in cameraActivities) {
+                    requireActivity().grantUriPermission(
+                        cameraActivity.activityInfo.packageName,
+                        photoUri,
+                        Intent.FLAG_GRANT_WRITE_URI_PERMISSION
+                    )
+                }
+
+                startActivityForResult(captureImage, REQUEST_PHOTO)
+            }
+        }   

    }

+    fun getScaledBitmap(path: String, activity: Activity): Bitmap {
+        val size = Point()
+        activity.windowManager.defaultDisplay.getSize(size)
+
+        return getScaleBitmap(path, size.x, size.y)
+    }

+    fun getScaleBitmap(path: String, destWidth: Int, destHeight: Int): Bitmap {
+        var options = BitmapFactory.Options()
+        options.inJustDecodeBounds = true
+        BitmapFactory.decodeFile(path, options)
+
+        val srcWidth = options.outWidth.toFloat()
+        val srcHeight = options.outHeight.toFloat()
+
+        var inSampleSize = 1
+
+        if (srcHeight > destHeight || srcWidth > destWidth) {
+            val heightScale = srcHeight / destHeight
+            val widthScale = srcWidth / destWidth
+
+            val simpleScale = if (heightScale > widthScale) {
+                heightScale
+            } else {
+                widthScale
+            }
+
+            inSampleSize = Math.round(simpleScale)
+        }
+
+        options = BitmapFactory.Options()
+        options.inSampleSize = inSampleSize
+
+        return BitmapFactory.decodeFile(path, options)
+    }

    override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {
        super.onActivityResult(requestCode, resultCode, data)
        
        when (requestCode) {
            ...
+            REQUEST_PHOTO -> {
+                // 收回权限
+                requireActivity().revokeUriPermission(photoUri, Intent.FLAG_GRANT_WRITE_URI_PERMISSION)

+                if (photoFile.exists()) {
+                    crimePhotoView.setImageBitmap(getScaledBitmap(photoFile.path, requireActivity()))
+                } else {
+                    crimePhotoView.setImageDrawable(null)
+                }
+            }
        }
    }


    override fun onDetach() {
        super.onDetach()
+        requireActivity().revokeUriPermission(photoUri, Intent.FLAG_GRANT_WRITE_URI_PERMISSION)
    }
  ]]>
    </c:sourceContent>

    <c:comment>
      <c:comment1>
        <![CDATA[]]>
      </c:comment1>
    </c:comment>
  </c:entry>








  <c:entry style="margin-top:1em;color:rgb(175, 0, 190);font-size:2.2em;">
    <c:title>MVVM &amp;mdash; BeatBox </c:title>
    <c:desc>
      <c:desc1> <![CDATA[
      
      ]]></c:desc1>
    </c:desc>

    <c:sourceContent type="" title="导入声音资源文件 assets" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:0em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
1. 右键 app 模块 > New > Folder > Assets Folder
2. 右键 assets 子目录 > New > Diectory > 输入 sample_sounds

# app/src/main/java/com/android_labs/beatbox/Sound.kt
package com.android_labs.beatbox

class Sound(private val assetPath: String) {
    val name = assetPath.split("/").last().removeSuffix(".wav")
}

# app/src/main/java/com/android_labs/beatbox/BeatBox.kt
package com.android_labs.beatbox

import android.content.res.AssetManager
import java.lang.Exception

private const val SOUNDS_FOLDER = "sample_sounds"

class BeatBox(private val assets: AssetManager) {

    val sounds: List<Sound>

    init {
        sounds = loadSounds()
    }

    private fun loadSounds(): List<Sound> {
        try {
            val soundNames = assets.list(SOUNDS_FOLDER)?.asList()

            if (soundNames != null) {
                return soundNames.map{ filename ->
                    Sound(filename)
                }
            }
        } catch (e: Exception) {
            return emptyList()
        }

        return emptyList()
    }
}
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/layout/activity_main.xml/activity_main.xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.recyclerview.widget.RecyclerView
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity">

</androidx.recyclerview.widget.RecyclerView>

# app/build.gradle.kts
plugins {
    ...

    id("kotlin-kapt")
}

android {
    ....

    // 启用数据绑定工具
+    dataBinding {
+        enable = true
+    }
}

dependencies {
    ...

+    implementation("androidx.lifecycle:lifecycle-extensions:2.2.0")
+    implementation("androidx.recyclerview:recyclerview:1.3.2")
}
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="将一般布局改为数据绑定布局" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/layout/activity_main.xml
<?xml version="1.0" encoding="utf-8"?>
<!-- 当使用 <layout /> 时, 数据绑定工具会帮你生成一个绑定类 (binding class) -->
<!-- 新生成的绑定类默认以布局文件命名，再加个 Binding 后缀。 例如: ActivityMainBinding-->
+ <layout
+    xmlns:android="http://schemas.android.com/apk/res/android">
    <androidx.recyclerview.widget.RecyclerView
-        xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:tools="http://schemas.android.com/tools"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:padding="2dp"
        tools:context=".MainActivity">

    </androidx.recyclerview.widget.RecyclerView>
+ </layout>

# app/src/main/java/com/android_labs/beatbox/MainActivity.kt
class MainActivity : AppCompatActivity() {

+    private lateinit var beatBox: BeatBox

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
-        setContentView(R.layout.activity_main)
        
+        beatBox = BeatBox(assets)

+        val binding: ActivityMainBinding = DataBindingUtil.setContentView(this, R.layout.activity_main)

+        binding.recycleView.apply {
+            layoutManager = GridLayoutManager(context, 3)
+        }
    }
}
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="创建按钮布局" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/layout/list_item_sound.xml
<layout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools">
    <Button
        android:layout_width="match_parent"
        android:layout_height="120dp"
        android:layout_margin="0dp"
        android:insetLeft="2dp"
        android:insetTop="2dp"
        android:insetRight="2dp"
        android:insetBottom="2dp"
        android:padding="0dp"
        app:cornerRadius="0dp"
        tools:text="Sound Name" />
</layout>

# app/src/main/java/com/android_labs/beatbox/MainActivity.kt
class MainActivity : AppCompatActivity() {

+    private inner class SoundHolder(private val binding: ListItemSoundBinding) :
+        RecyclerView.ViewHolder(binding.root) {
+
+    }

+    private inner class SoundAdapter(): RecyclerView.Adapter<SoundHolder>() {
+        override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): SoundHolder {
+            val binding = DataBindingUtil.inflate<ListItemSoundBinding>(
+                layoutInflater, R.layout.list_item_sound, parent, false
+            )
+
+            return SoundHolder(binding)
+        }
+
+        override fun getItemCount(): Int {
+            return 0
+        }
+
+        override fun onBindViewHolder(holder: SoundHolder, position: Int) {
+
+        }
+    }
}

# app/src/main/java/com/android_labs/beatbox/MainActivity.kt
class MainActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
-        setContentView(R.layout.activity_main)
        val binding: ActivityMainBinding = DataBindingUtil.setContentView(this, R.layout.activity_main)

        binding.recycleView.apply {
            layoutManager = GridLayoutManager(context, 3)
+           adapter = SoundAdapter(beatBox.sounds)
        }
    }
}
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="创建视图模型" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/beatbox/SoundViewModel.kt 
class SoundViewModel {

    var sound: Sound? = null
        set(sound) {
            field = sound
        }

    var title: String? = null
        get() = sound?.name

}

# app/src/main/res/layout/list_item_sound.xml 
<layout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools">

+    <data>
         <!-- 再绑定类上定义一个 viewModel 属性 -->
+        <variable
+            name="viewModel"
+            type="com.android_labs.beatbox.SoundViewModel" />
+    </data>

    <Button
        android:layout_width="match_parent"
        android:layout_height="120dp"
        android:layout_margin="0dp"
        android:insetLeft="2dp"
        android:insetTop="2dp"
        android:insetRight="2dp"
        android:insetBottom="2dp"
        android:padding="0dp"
        app:cornerRadius="0dp"
+        android:text="@{viewModel.title}"
        tools:text="Sound Name" />
</layout>


# app/src/main/java/com/android_labs/beatbox/MainActivity.kt 
private inner class SoundHolder(private val binding: ListItemSoundBinding) :
    RecyclerView.ViewHolder(binding.root) {

+    init {
+        binding.viewModel = SoundViewModel()
+    }
+
+    fun bind(sound: Sound) {
+        binding.apply {
+            viewModel?.sound = sound
+            // 立即刷新视图
+            executePendingBindings()
+        }
+    }
}

# app/src/main/java/com/android_labs/beatbox/MainActivity.kt 
private inner class SoundAdapter(private val sounds: List<Sound>): RecyclerView.Adapter<SoundHolder>() {

    ...

    override fun onBindViewHolder(holder: SoundHolder, position: Int) {
+        holder.bind(sounds[position])
    }
}
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="让视图模型和布局文件联动起来 — BaseObservable" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/beatbox/SoundViewModel.kt 
- class SoundViewModel {
+ class SoundViewModel: BaseObservable() {

    var sound: Sound? = null
        set(sound) {
            field = sound
             // 通知视图绑定类, 视图模型对象上所有可绑定属性都已更新。
+            notifyChange()
        }

+    @get:Bindable
    var title: String? = null
        get() = sound?.name

}
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="让视图模型和布局文件联动起来 — LiveData" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/beatbox/SoundViewModel.kt 
class SoundViewModel {

+    var title: MutableLiveData<String?> = MutableLiveData()

    var sound: Sound? = null
        set(sound) {
            field = sound
+            title.postValue(sound?.name)
        }

-    var title: String? = null
-        get() = sound?.name

}

# app/src/main/java/com/android_labs/beatbox/MainActivity.kt
private inner class SoundAdapter(private val sounds: List<Sound>): RecyclerView.Adapter<SoundHolder>() {
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): SoundHolder {
        val binding = DataBindingUtil.inflate<ListItemSoundBinding>(
            layoutInflater, R.layout.list_item_sound, parent, false
        )

+        binding.lifecycleOwner = this@MainActivity

        return SoundHolder(binding)
    }
}
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="播放音频" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/beatbox/BeatBox.kt 

+ private const val TAG = "BeatBox"
+ private const val MAX_SOUNDS = 5
private const val SOUNDS_FOLDER = "sample_sounds"

- class Sound(val assetPath: String) {
+ class Sound(val assetPath: String, var soundId: Int? = null) {
    val name = assetPath.split("/").last().removeSuffix(".wav")
}

class BeatBox(private val assets: AssetManager) {

    val sounds: List<Sound>

+    private val soundPool = SoundPool.Builder().setMaxStreams(MAX_SOUNDS).build()

    init {
        sounds = loadSounds()
    }

+    private fun load(sound: Sound) {
+        var afd: AssetFileDescriptor = assets.openFd(sound.assetPath)
+        var soundId = soundPool.load(afd, 1)
+        sound.soundId = soundId
+    }

+    fun play(sound: Sound) {
+        sound.soundId?.let {
+            soundPool.play(it, 1.0f, 1.0f, 1, 0, 1.0f)
+        }
+    }

    private fun loadSounds(): List<Sound> {
        try {
            val soundNames = assets.list(SOUNDS_FOLDER)?.asList()

            if (soundNames != null) {
-                return soundNames.map{ filename ->
-                    Sound(filename)
-                }

+                return soundNames.map { filename ->
+                    val assetPath = "$SOUNDS_FOLDER/$filename"
+                    val sound = Sound(assetPath)
+
+                    try {
+                        load(sound)
+                    } catch (ioe: IOException) {
+                        Log.e(TAG, "Could not load sound $filename", ioe)
+                    }
+
+                    sound
+                }
            }
        } catch (e: Exception) {
            return emptyList()
        }

        return emptyList()
    }
}

# app/src/main/java/com/android_labs/beatbox/SoundViewModel.kt 
- class SoundViewModel {
+ class SoundViewModel(private val beatBox: BeatBox) {

    var title: MutableLiveData<String?> = MutableLiveData()

    var sound: Sound? = null
        set(sound) {
            field = sound
            title.postValue(sound?.name)
        }

+    fun onButtonClicked() {
+        sound?.let {
+            beatBox.play(it)
+        }
+    }
}

# app/src/main/java/com/android_labs/beatbox/MainActivity.kt 
private inner class SoundHolder(private val binding: ListItemSoundBinding) :
    RecyclerView.ViewHolder(binding.root) {

    init {
-        binding.viewModel = SoundViewModel()
+        binding.viewModel = SoundViewModel(beatBox)
    }

    fun bind(sound: Sound) {
        binding.apply {
            viewModel?.sound = sound
            executePendingBindings()
        }
    }
}

# app/src/main/res/layout/list_item_sound.xml 
<layout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools">

    <data>
        <variable
            name="viewModel"
            type="com.android_labs.beatbox.SoundViewModel" />
    </data>

    <Button
        android:layout_width="match_parent"
        android:layout_height="120dp"
        android:layout_margin="0dp"
        android:insetLeft="2dp"
        android:insetTop="2dp"
        android:insetRight="2dp"
        android:insetBottom="2dp"
        android:padding="0dp"
+        android:onClick="@{() -> viewModel.onButtonClicked()}"
        android:text="@{viewModel.title}"
        app:cornerRadius="0dp"
        tools:text="Sound Name" />
</layout>
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="释放音频" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# app/src/main/java/com/android_labs/beatbox/BeatBox.kt 
class BeatBox(private val assets: AssetManager) {

    ...
+    fun release() {
+        soundPool.release()
+    }

    ...
}

class MainActivity : AppCompatActivity() {

    ...    
+    override fun onDestroy() {
+        super.onDestroy()
+        beatBox.release()
+    }

    ...
}
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="播放进度控制 SeekBar" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
// 挑战练习
// 使用 SeekBar 部件控制 SoundPool 的 play (Int, Float, Float, Int, Int Float)
// TODO
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="BeatBox 样式与主题" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/values/colors.xml 
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <color name="black">#FF000000</color>
    <color name="white">#FFFFFFFF</color>

+    <color name="red">#F44336</color>
+    <color name="dark_red">#C3352B</color>
+    <color name="gray">#607D8B</color>
+    <color name="soothing_blue">#0083BF</color>
+    <color name="dark_blue">#005A8A</color>
</resources>

# app/src/main/res/values/themes.xml
<resources xmlns:tools="http://schemas.android.com/tools">
    <!-- Base application theme. -->
    <style name="Base.Theme.BeatBox" parent="Theme.Material3.DayNight">
        <item name="windowActionBar">true</item>
        <item name="windowNoTitle">false</item>
    </style>

    <style name="Theme.BeatBox" parent="Base.Theme.BeatBox">
        <item name="colorPrimary">@color/soothing_blue</item> <!-- 用于应用栏 -->
        <item name="colorPrimaryDark">@color/dark_red</item> <!-- 用于屏幕顶部状态栏 -->
        <item name="colorAccent">@color/gray</item>
    </style>

    <style name="BeatBoxButton">
        <!-- <item name="android:background">@color/dark_blue</item> -->
    </style>
    <style name="BeatBoxButton.Strong">
        <item name="android:textStyle">bold</item>
    </style>
</resources>

# app/src/main/res/layout/list_item_sound.xml
<layout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools">

    ....

    <Button
+        style="@style/BeatBoxButton"
        android:layout_width="match_parent"
        android:layout_height="120dp"
        android:layout_margin="0dp"
        android:insetLeft="2dp"
        android:insetTop="2dp"
        android:insetRight="2dp"
        android:insetBottom="2dp"
        android:padding="0dp"
        android:onClick="@{() -> viewModel.onButtonClicked()}"
        android:text="@{viewModel.title}"
        app:cornerRadius="0dp"
        tools:text="Sound Name" />
</layout>
  ]]>
    </c:sourceContent>
    <c:comment>
      <c:comment1>
        <![CDATA[]]>
      </c:comment1>
    </c:comment>
  </c:entry>




  <c:entry style="margin-top:1em;color:rgb(175, 0, 190);font-size:2.2em;">
    <c:title><![CDATA[PhotoGallery &mdash; HTTP 与 后台任务]]></c:title>
    <c:desc>
      <c:desc1> <![CDATA[
      
      ]]></c:desc1>
    </c:desc>

    <c:sourceContent type="" title="Makefile" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:0em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
### 当前 Makefile 文件物理路径
ROOT_DIR:=$(shell dirname $(realpath $(firstword $(MAKEFILE_LIST))))

build:
  ./gradlew build -x test

tasks:
  ./gradlew tasks

install:
  ./gradlew installDebug
  ]]>
    </c:sourceContent>

    <c:sourceContent type="" title="Update app/build.gradle.kts" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# app/build.gradle.kts
plugins {
    id("com.android.application")
    id("org.jetbrains.kotlin.android")
+    id("kotlin-kapt")
}

dependencies {

    implementation("androidx.core:core-ktx:1.12.0")
    implementation("androidx.appcompat:appcompat:1.6.1")
    implementation("com.google.android.material:material:1.11.0")
    implementation("androidx.constraintlayout:constraintlayout:2.1.4")

+    implementation("androidx.lifecycle:lifecycle-extensions:2.2.0")
+    implementation("androidx.recyclerview:recyclerview:1.3.2")
+    implementation("androidx.room:room-runtime:2.6.1")

+    kapt("androidx.room:room-compiler:2.6.1")
}
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="新建 PhotoGalleryActivity" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# app/src/main/res/layout/fragment_photo_gallery.xml 
<?xml version="1.0" encoding="utf-8"?>
<androidx.recyclerview.widget.RecyclerView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:id="@+id/photo_recycler_view">

</androidx.recyclerview.widget.RecyclerView>

# app/src/main/java/com/android_labs/photogallery/PhotoGalleryFragment.kt
class PhotoGalleryFragment: Fragment() {
    companion object {
        fun newInstance(): PhotoGalleryFragment {
            return PhotoGalleryFragment()
        }
    }

    private lateinit var photoRecyclerView: RecyclerView

    override fun onCreateView(
        inflater: LayoutInflater,
        container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_photo_gallery, container, false)

        this.photoRecyclerView = view.findViewById(R.id.photo_recycler_view)
        this.photoRecyclerView.layoutManager = GridLayoutManager(context, 3)

        return view
    }
}

# app/src/main/java/com/android_labs/photogallery/PhotoGalleryActivity.kt
class PhotoGalleryActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_photo_gallery)

        val isFragmentContainerEmpty = savedInstanceState == null

        if (isFragmentContainerEmpty) {
            supportFragmentManager.beginTransaction()
                .add(R.id.fragment_container, PhotoGalleryFragment.newInstance()).commit()
        }
    }
}

# app/src/main/res/layout/activity_photo_gallery.xml 
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:id="@+id/fragment_container"
    tools:context=".PhotoGalleryActivity">

</FrameLayout>

# app/src/main/AndroidManifest.xml
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools">
    <application
        android:allowBackup="true"
        android:dataExtractionRules="@xml/data_extraction_rules"
        android:fullBackupContent="@xml/backup_rules"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/Theme.PhotoGallery"
        tools:targetApi="31">
        <activity
            android:name=".MainActivity"
            android:exported="false" />
        <activity
            <!-- 将 PhotoGalleryActivity 设置为启动 activity -->
            android:name=".PhotoGalleryActivity"
            android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
</manifest>
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="Retrofit HTTP 客户端" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# 配置网络权限
# app/src/main/AndroidManifest.xml
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools">
    ...

+    <uses-permission android:name="android.permission.INTERNET" />   
    ...
</manifest>

# app/build.gradle.kts
dependencies {
    
    ...

+    implementation("com.squareup.retrofit2:retrofit:2.5.0")
+    implementation("com.squareup.retrofit2:converter-scalars:2.5.0")
}

# app/src/main/java/com/android_labs/photogallery/FlickrApi.kt
import retrofit2.Call
import retrofit2.http.GET

interface FlickrApi {

    @GET("/")
    fun fetchContents(): Call<String>
}

# app/src/main/java/com/android_labs/photogallery/FlickrFetchr.kt
private const val TAG ="FlickrFetchr"
const val FLICKR_BASE_URL = "https://api.flickr.com"

class FlickrFetchr {

    private val flickrApi: FlickrApi

    init {

        val retrofit: Retrofit = Retrofit.Builder().baseUrl(FLICKR_BASE_URL)
            .addConverterFactory(ScalarsConverterFactory.create()).build()

        flickrApi = retrofit.create(FlickrApi::class.java)
    }

    fun fetchContents(): LiveData<String> {
        val responseLiveData: MutableLiveData<String> = MutableLiveData()
        val flickrHomePageRequest: Call<String> = flickrApi.fetchContents()

        flickrHomePageRequest.enqueue(object: Callback<String> {
            override fun onResponse(call: Call<String>, response: Response<String>) {
                val apiUrl = flickrPhotoPageRequest.request().url().toString()
                var response = response.body()

                responseLiveData.value = response
                Log.d(TAG, "Response-received: apiUrl=$apiUrl, response=$response")
            }

            override fun onFailure(call: Call<String>, t: Throwable) {
                Log.e(TAG, "Failed to fetch photos", t)
            }
        })

        return responseLiveData
    }
}

# app/src/main/java/com/android_labs/photogallery/PhotoGalleryFragment.kt
+    override fun onCreate(savedInstanceState: Bundle?) {
+        super.onCreate(savedInstanceState)
+
+        val flickrLiveData: LiveData<String> = FlickrFetchr().fetchPhotos()
+
+        flickrLiveData.observe(this, Observer { responseString ->
+            Log.d(TAG, "Response received: $responseString")
+        })
+    }
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="从 Flicker 获取 JSON 数据" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# 注册 Flickr 账号并申请 API key
// ....

# 得到 API key 后，可以直接向 Flickr 发送请求
// > https://api.flickr.com/services/rest/?method=flickr.interestingness.getList&api_key=<you key here>&format=json&nojsoncallback=1&extras=url_s

# app/src/main/java/com/android_labs/photogallery/FlickrApi.kt
import retrofit2.Call
import retrofit2.http.GET

interface FlickrApi {

    @GET("/")
    fun fetchContents(): Call<String>

+    @GET("/services/rest/?method=flickr.interestingness.getList&api_key=<you key here>&format=json&nojsoncallback=1&extras=url_s")
+    fun fetchPhotos(): Call<String>
}
  ]]>
    </c:sourceContent>
    <c:sourceContent type="" title="Retrofit 反序列化 JSON" id="sourceContent1" 
                     style="background-color:white;"
                     titleStyle="padding:.5em 0em 0em 0em;margin-top:0em;margin-top:1em;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
                     <![CDATA[
# app/build.gradle.kts
dependencies {
+    implementation ("com.google.code.gson:gson:2.8.6")

+    implementation ("com.squareup.retrofit2:retrofit:2.9.0")
+    implementation ("com.squareup.retrofit2:converter-gson:2.9.0")
+    implementation ("com.squareup.retrofit2:converter-scalars:2.7.1")
}

# app/src/main/java/com/android_labs/photogallery/GalleryItem.kt
data class GalleryItem (
    var id: String = "",
    var title: String = "",
    @SerializedName("url_s") var url: String = "",
)

# app/src/main/java/com/android_labs/photogallery/PhotoResponse.kt
class PhotoResponse {
    @SerializedName("photo")
    lateinit var galleryItems: List<GalleryItem>
}

# app/src/main/java/com/android_labs/photogallery/FlickrResponse.kt
class FlickrResponse {
    lateinit var photos: PhotoResponse
}

# app/src/main/java/com/android_labs/photogallery/FlickrApi.kt
interface FlickrApi {

-    fun fetchPhotos(): Call<String>
+    fun fetchPhotos(): Call<FlickrResponse>
}

# app/src/main/java/com/android_labs/photogallery/FlickrFetchr.kt
class FlickrFetchr {

    init {

        val retrofit: Retrofit = Retrofit.Builder().baseUrl(FLICKR_BASE_URL)
-            .addConverterFactory(ScalarsConverterFactory.create())
+            .addConverterFactory(GsonConverterFactory.create())
            .build()

    }

+    fun fetchPhotos(): LiveData<List<GalleryItem>> {
+        val responseLiveData: MutableLiveData<List<GalleryItem>> = MutableLiveData()
+        val flickrPhotoPageRequest: Call<FlickrResponse> = flickrApi.fetchPhotos()
+
+        flickrPhotoPageRequest.enqueue(object: Callback<FlickrResponse> {
+            override fun onResponse(call: Call<FlickrResponse>, response: Response<FlickrResponse>) {
+                val apiUrl = flickrPhotoPageRequest.request().url().toString()
+                val galleryItems = response.body()?.photos?.galleryItems ?: mutableListOf()
+
+                responseLiveData.value = galleryItems
+
+                Log.d(TAG, "Response-received: apiUrl=$apiUrl, response=${galleryItems.size}")
+            }
+
+            override fun onFailure(call: Call<FlickrResponse>, t: Throwable) {
+                Log.e(TAG, "Failed to fetch photos", t)
+            }
+        })
+
+        return responseLiveData
+    }
}

  ]]>
    </c:sourceContent>
    <c:comment>
      <c:comment1>
        <![CDATA[]]>
      </c:comment1>
    </c:comment>
  </c:entry>



</c:component>
