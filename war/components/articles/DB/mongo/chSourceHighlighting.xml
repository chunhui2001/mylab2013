<?xml version="1.0" encoding="utf-8"?>
<c:component type="chSourceHighlighting" componentId="chSourceHighlighting_1" xmlns:c="http://com.snnmo.website">
  <c:abstract>
    <![CDATA[
<b>
mongorestore 	-d rebate &lt;path to the backup&gt; 
<br />
<br />
mongodump -h 172.27.5.71:27017 -d rebate -o Documents/ -u rebateprd1 -p pwd_here
</b>
]]>
  </c:abstract>

  <c:entry style="margin-top:1em;color:rgb(175, 0, 190);font-size:2.2em;">
    <c:title>手动安装</c:title>
    <c:desc>
      <c:desc1> <![CDATA[]]></c:desc1>
    </c:desc>
    <c:sourceContent type="html" title="下载源文件（二进制编译版）" id="sourceContent1"
                     titleStyle="padding-left:0;color:black;font-size:1.8em;background-color:white;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
      <![CDATA[
      <pre># mkdir -p /data/src
# cd /data/src
# wget http://fastdl.mongodb.org/linux/mongodb-linux-x86_64-2.6.1.tgz
# tar -zvxf mongodb-linux-x86_64-2.6.1.tgz
# mv mongodb-linux-x86_64-2.6.1 /opt/mongodb/</pre>
    ]]>
    </c:sourceContent>
    <c:sourceContent type="html" title="配置环境变量" id="sourceContent1" style="margin-top:2em;"
                     titleStyle="padding-left:0;color:black;font-size:1.8em;background-color:white;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
      <![CDATA[
      <pre>vim /etc/profile

添加下面的内容：
export MONGODB_HOME=/opt/mongodb
export PATH=$MONGODB_HOME/bin:$PATH

让环境变量生效:
source /etc/profile

验证环境变量是否生效:
# mongod -version</pre>
]]>
    </c:sourceContent>
    <c:sourceContent type="html" title="建立存储数据及日志的目录" id="sourceContent1" style="margin-top:2em;"
                     titleStyle="padding-left:0;color:black;font-size:1.8em;background-color:white;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
      <![CDATA[
      <pre>建立目录:
# mkdir -p /data/mongodb/journal
# mkdir -p /data/mongodb/log

建立日志文件:
# touch /data/mongodb/log/mongodb.log

建立配置文件
# vim /etc/mongodb.conf

<b>dbpath=/data/mongodb
logpath=/data/mongodb/log/mongodb.log
logappend=true
port=27017
fork=true
noauth=true
nojournal=true
smallfiles=true
noprealloc=true</b></pre>
]]>
    </c:sourceContent>
    <c:sourceContent type="html" title="增加mongodb用户及设置权限" id="sourceContent1" style="margin-top:2em;"
                     titleStyle="padding-left:0;color:black;font-size:1.8em;background-color:white;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
      <![CDATA[
      <pre>增加用户:
# useradd mongodb -M -s /sbin/nologin

设置目录权限:
#chown -R mongodb.mongodb /data/mongodb</pre>
]]>
    </c:sourceContent>
    <c:sourceContent type="html" title="运行mongod服务" id="sourceContent1" style="margin-top:2em;"
                     titleStyle="padding-left:0;color:black;font-size:1.8em;background-color:white;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
      <![CDATA[
      <pre>mongod -f /etc/mongodb.conf</pre>
]]>
    </c:sourceContent>
    <c:comment>
      <c:comment1>
        <![CDATA[]]>
      </c:comment1>
    </c:comment>
  </c:entry>
  
<c:entry style="margin-top:2em;color:rgb(175, 0, 190);font-size:2.2em;">
    <c:title>增加用户认证</c:title>
    <c:desc>
      <c:desc1> <![CDATA[]]></c:desc1>
    </c:desc>
    <c:sourceContent type="html" title="创建用户" id="sourceContent1"
                     titleStyle="padding-left:0;color:black;font-size:1.8em;background-color:white;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
      <![CDATA[
      <pre>Create root account:
#####################
use admin;

db.createUser({
	user: 'root',
	pwd:'cc',
	roles:['root']
});</pre>
    ]]>
    </c:sourceContent>
   <c:sourceContent type="html" title="--auth" id="sourceContent1" style="margin-top:2em;"
                     titleStyle="padding-left:0;color:black;font-size:1.8em;background-color:white;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
      <![CDATA[
      <pre>Remove and reinstall mongodb with option --auth:
#####################
mongod --remove
mongod --install --auth --dbpath "/opt/mongodb/data" --logpath "/opt/mongodb/logs/mongo.log"

1. Relogin mongo and enable auth:
----------------------------------
mongo localhost;
user admin;
db.auth('root', 'cc');

2. Create new Database:
----------------------------
db.runCommand({create:"blog"});
use blog;

3. Create new Database:
----------------------------
db.createUser({
	user:'blog',
	pwd:'cc',
	roles:['readWrite', 'dbAdmin']
});</pre>
    ]]>
    </c:sourceContent>
  <c:sourceContent type="html" title="directoryperdb " id="sourceContent1" style="margin-top:2em;"
                     titleStyle="padding-left:0;color:black;font-size:1.8em;background-color:white;"
                     bodyStyle="background-color:white;padding:0;font-size:1.2em;line-height:1.3;font-family:monospace;">
      <![CDATA[
      <pre>Create each db with each folder
############################################################
1. Stop mongodb and remove
mongod --stop && mongod --remove

2. and move the old to each folder 
.....

3. and then install mongodb with option --directoryperdb)
mongod --install --auth --directoryperdb --dbpath "/opt/mongodb/data" --logpath "/opt/mongodb/logs/mongo.log"

4. repeat the step with "Remove and reinstall mongodb with option --auth: step{1..3}"

5. verify the database folder if the data file into a single folder</pre>
    ]]>
    </c:sourceContent>
    <c:comment>
      <c:comment1>
        <![CDATA[]]>
      </c:comment1>
    </c:comment>
  </c:entry>

  
</c:component>
